<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Ideal Bank</title>
    <style>
        
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f0f0;
            text-align: center;
        }
        .header {
            background-color: #e9ecef;
            color: white;
            padding: 10px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            position: relative;
        }
        .header img {
            max-width: 200px;
        }
        .header .date-time {
            position: absolute;
            top: 10px;
            left: 10px;
            color: royalblue;
            text-align: left;
        }
        .header .date-time p {
            margin: 0;
            display: flex;
            align-items: center;
        }
        .header .date-time p img,
        .header .profile-actions button img {
            margin-right: 5px;
            width: 40px; 
            height: 40px; 
        }
        .header .profile-actions {
    position: absolute;
    top: 10px;
    right: 10px;  
    transform: translateX(-0.5cm); 
    text-align: right;
}
        .header .profile-actions button {
            background-color: #004085;
            color: white;
            border: none;
            padding: 6.5px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            display: flex;
            align-items: center;
        }
        .header .profile-actions button img {
            margin-right: 5px;
            width: 21px;
            height: 21px;
        }
        .marquee {
            background-color: #004085;
            color: white;
            padding: 10px;
            font-size: 18px;
            white-space: nowrap;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            position: relative;
            height: 40px;
            line-height: 40px;
        }
        .marquee span {
            display: inline-block;
            padding-left: 100%;
            animation: marquee 15s linear infinite;
        }
        @keyframes marquee {
            from {
                transform: translateX(0);
            }
            to {
                transform: translateX(-100%);
            }
        }
        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            margin-top: -20px; /* Adjusted margin for the header */
        }
        .profile-info {
            background-color: #ffffff;
            padding: 20px;
            margin: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 1200px;
            text-align: left;
            display: none;
        }
        .profile-info h1 {
            font-size: 24px;
            margin-bottom: 20px;
        }
        .profile-tables {
            display: flex;
            justify-content: space-between;
            overflow-x: auto;
        }
        .profile-tables .table-container {
            width: 45%;
        }
        .profile-tables table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            table-layout: fixed;
        }
        .profile-tables table, .profile-tables th, .profile-tables td {
            border: 1px solid #ddd;
        }
        .profile-tables th, .profile-tables td {
            padding: 10px;
            text-align: left;
            white-space: nowrap; 
            overflow: hidden; 
            text-overflow: ellipsis; 
        }
        .profile-tables th {
            background-color: #f4f4f4;
            width: 30%;

        }
        .profile-tables td {
            width: 70%;
        }
        .profile-tables td input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 5px;
            box-sizing: border-box;
        }
        .btn-container {
            text-align: center;
        }
        .btn-container button {
            background-color: #004085;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
        }
        .footer {
  background-color: #004085;
  color: white;
  padding: 10px;
  text-align: center;
  position: fixed;
  width: 100%;
  bottom: 0;
  left: 0;
  margin: 0; /* Add this property */
}
        .main-content {
            margin: 20px;
        }

        .button-row {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }

        .button-row button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 15px 25px;
            margin: 0;
            border-right: 2px solid white;
            cursor: pointer;
            flex: 1;
            transition: background-color 0.3s ease;
        }

        .button-row button:hover {
            background-color: #0056b3;
        }

        .button-row button:last-child {
            border-right: none;
        }

     /* Fund Transfer Panel */
     .fund-transfer {
            background-color: #ffffff;
            padding: 20px;
            margin: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            display: none; /* Hidden initially */
            max-width: 800px;
            margin: auto; /* Center the panel */
        }

        .fund-transfer h2 {
            font-size: 24px;
            margin-bottom: 20px;
            text-align: center; /* Center align title */
        }

        /* Flexbox styling for side-by-side buttons with dynamic resizing */
        .fund-transfer-options {
            display: flex;
            flex-wrap: wrap;
            gap: 15px; /* Adds space between buttons */
            justify-content: center; /* Center the buttons */
        }

        .fund-transfer-options button {
            flex: 1 1 180px;
            max-width: 300px;
            padding: 15px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            text-align: center;
            transition: background-color 0.3s ease;
            font-size: 16px;
        }

        .fund-transfer-options button:hover {
            background-color: #0056b3;
        }

        /* Responsive layout for smaller screens */
        @media (max-width: 768px) {
            .fund-transfer-options button {
                flex: 1 1 100%;
                font-size: 14px;
            }
        }

        /* Form styles */
        
        .transfer-form {
        display: flex;
        flex-direction: column;
        gap: 10px;
        padding: 20px;
        border: 1px solid #ccc;
        border-radius: 5px;
        max-width: 500px; /* Adjust as needed */
        margin: 0 auto;
    }

    .transfer-form label {
        font-size: 1.2em;
    }

    /* Common styles for form fields */
.transfer-form input,
.transfer-form select {
    font-size: 1.2em; /* Increase font size for better visibility */
    padding: 12px; /* Increase padding for better touch */
    border: 1px solid #ddd;
    border-radius: 4px;
    width: 100%; /* Full width for each field */
    box-sizing: border-box; /* Ensure padding and border are included in total width */
    margin-bottom: 15px; /* Add space between fields */
}

/* Ensures each label is on a separate line */
.transfer-form label {
    display: block; /* Make labels block elements to ensure they are on their own line */
    font-size: 1.2em; /* Increase font size for better visibility */
    margin-bottom: 5px; /* Space between label and input */
}
/* Add styles to hide and show elements */
.upi-buttons, .upi-form, .send-money-form {
    display: none;
}

/* Styles for RTGS form */
.rtgs-form {
    display: flex;
    flex-direction: column; /* Stack fields vertically */
    gap: 15px; /* Space between fields */
    padding: 20px; /* Padding around the form */
    border: 1px solid #ccc; /* Border around the form */
    border-radius: 8px; /* Rounded corners */
    background-color: #f9f9f9; /* Light background color */
}

/* Specific styles for form description and errors */
.rtgs-form .description {
    font-size: 1em; /* Font size for instructions */
    color: #555; /* Darker color for text */
    margin-bottom: 20px; /* Space below description */
}

.rtgs-form .error {
    color: #d9534f; /* Error text color */
    font-size: 0.9em; /* Slightly smaller font size for errors */
}
.rtgs-form button, .neft-form button {
    padding: 15px 30px;
    font-size: 18px;
    border-radius: 10px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    cursor: pointer;
}

.rtgs-form button:active, .neft-form button:active {
    background-color: #004085; /* Change the background color on click */
    box-shadow: 0 0 0 rgba(0, 0, 0, 0.1); /* Remove the shadow on click */
    transform: translateY(2px); /* Add a slight movement on click */
}

/* Demand Draft Form Styles */
.dd-form {
    display: none; /* Hidden initially */
    background-color: #f9f9f9;
    padding: 20px;
    margin: 20px auto;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    max-width: 500px;
}

.dd-form h2 {
    font-size: 24px;
    margin-bottom: 20px;
    text-align: center;
}

.dd-form .form-info {
    font-size: 1em;
    color: #555;
    margin-top: 10px;
}
.dd-button {
    background-color: #007bff;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 5px;
    cursor: pointer;
    font-size: 16px;
    transition: background-color 0.3s ease;
}

.dd-button:hover {
    background-color: #0056b3;
}

.dd-button:disabled {
    background-color: #c0c0c0;
    cursor: not-allowed;
}
/* IMPS Form Specific Styles */
.imps-form {
    background-color: #f9f9f9;
    border: 1px solid #ccc;
    padding: 20px;
    border-radius: 8px;
    max-width: 400px;
    margin: 20px auto;
    display: none;
}

.imps-form h2 {
    font-size: 24px;
    color: #333;
    margin-bottom: 15px;
    text-align: center;
}

.imps-form table {
    width: 100%;
    margin-bottom: 15px;
}

.imps-form th {
    text-align: left;
    padding: 10px 0;
    font-weight: normal;
    color: #555;
}

.imps-form td {
    padding: 10px 0;
}

.imps-form input[type="text"],
.imps-form input[type="number"] {
    width: 100%;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-sizing: border-box;
}

.imps-form .form-info {
    font-size: 12px;
    color: #666;
    margin-bottom: 10px;
    text-align: center;
}

.imps-form #sendImpsButton {
    background-color:#0056b3 ;
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    width: 100%;
    font-size: 16px;
}

.imps-form #sendImpsButton:hover {
    background-color: #45a049;
}

.imps-form .error-message {
    color: red;
    font-size: 14px;
    margin-top: 10px;
    text-align: center;
}

/* Additional media queries for responsiveness */
@media (max-width: 768px) {
    .imps-form {
        max-width: 100%;
        padding: 15px;
    }
}


.bill-payments {
    background-color: #ffffff;
    padding: 20px;
    margin: 20px;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    display: none; /* Initially hidden */
    max-width: 800px;
    margin: auto; /* Center the panel */
}

.bill-payments h2 {
    font-size: 24px;
    margin-bottom: 20px;
    text-align: center; /* Center align title */
}

.bill-payment-options {
    display: flex;
    flex-wrap: wrap;
    gap: 15px; /* Adds space between buttons */
    justify-content: center; /* Center the buttons */
}

.bill-payment-options button {
    flex: 1 1 180px;
    max-width: 300px;
    padding: 15px;
    background-color: #007bff;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    text-align: center;
    transition: background-color 0.3s ease;
    font-size: 16px;
}

.bill-payment-options button:hover {
    background-color: #0056b3;
}
.passbook-table {
    background-color: #ffffff;
    padding: 20px;
    margin: 20px;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    max-width: 800px;
    margin: auto; /* Center the panel */
}

.passbook-table h2 {
    font-size: 24px;
    margin-bottom: 20px;
    text-align: center; /* Center align title */
}

.passbook-table table {
    width: 100%;
    border-collapse: collapse;
}

.passbook-table th, .passbook-table td {
    border: 1px solid #ddd;
    padding: 10px;
    text-align: left;
}

.passbook-table th {
    background-color: #f0f0f0;
}

.date-range-selection {
    margin-top: 20px;
    display: flex;
    flex-wrap: wrap;
    gap: 15px; /* Adds space between inputs and button */
    justify-content: center; /* Center the inputs and button */
}

.date-range-selection label {
    font-size: 16px;
    margin-right: 10px;
}

.date-range-selection input[type="date"] {
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 5px;
}

#generateStatementButton {
    background-color: #007bff;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    padding: 10px 20px;
    font-size: 16px;
    transition: background-color 0.3s ease;
}

#generateStatementButton:hover {
    background-color: #0056b3;
}
.account-closure-form {
    background-color: #ffffff;
    padding: 20px;
    margin: 20px;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    max-width: 800px;
    margin: auto; /* Center the panel */
}

.account-closure-form h2 {
    font-size: 24px;
    margin-bottom: 20px;
    text-align: center; /* Center align title */
}

.account-closure-form form {
    display: flex;
    flex-direction: column;
    align-items: center;
}

.account-closure-form label {
    font-size: 16px;
    margin-bottom: 10px;
}

.account-closure-form textarea {
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 5px;
    width: 100%;
    height: 100px;
}

.account-closure-form button {
    background-color: #007bff;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    padding: 10px 20px;
    font-size: 16px;
    transition: background-color 0.3s ease;
}

.account-closure-form button:hover {
    background-color: #0056b3;
}

.confirmation-dialog {
    display: none; /* Hide by default */
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: #ffffff;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    width: 300px;
}

.transfer-details-form {
    display: none; /* Hide by default */
    background-color: #ffffff;
    padding: 20px;
    margin: 20px;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    max-width: 800px;
    margin: auto; /* Center the panel */
}
.fd-form {
    background-color: #f7f7f7;
    padding: 30px;
    border: 1px solid #ddd;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    max-width: 600px;
    margin: 40px auto; /* Center the panel */
}

.fd-form h2 {
    font-size: 20px;
    margin-bottom: 20px;
    text-align: center; /* Center align title */
    color: #333;
}

.fd-form label {
    display: block;
    margin-bottom: 10px;
    font-size: 16px;
    color: #666;
}

.fd-form select, .fd-form input[type="number"] {
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 5px;
    width: 100%;
    margin-bottom: 20px;
}

.fd-form button {
    background-color:#0056b3;
    color: #fff;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    padding: 10px 20px;
    font-size: 16px;
    transition: background-color 0.3s ease;
}

.fd-form button:hover {
    background-color:#0056b3;
}
.loan-mgmt-form {
    background-color: #f7f7f7;
    padding: 30px;
    border: 1px solid #ddd;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    max-width: 600px;
    margin: 40px auto; /* Center the panel */
}

.loan-mgmt-form h2 {
    font-size: 20px;
    margin-bottom: 20px;
    text-align: center; /* Center align title */
    color: #333;
}

.loan-mgmt-form label {
    display: block;
    margin-bottom: 10px;
    font-size: 16px;
    color: #666;
}

.loan-mgmt-form select, .loan-mgmt-form input[type="number"] {
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 5px;
    width: 100%;
    margin-bottom: 20px;
}

.loan-mgmt-form button {
    background-color:#0056b3;
    color: #fff;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    padding: 10px 20px;
    font-size: 16px;
    transition: background-color 0.3s ease;
}

.loan-mgmt-form button:hover {
    background-color:#0056b3;
}
.modal {
            display: none; 
            position: fixed; 
            z-index: 1; 
            left: 0;
            top: 0;
            width: 100%; 
            height: 100%; 
            overflow: auto; 
            background-color: rgb(0,0,0); 
            background-color: rgba(0,0,0,0.4); 
        }

        .modal-content {
            background-color: #fefefe;
            margin: 15% auto; 
            padding: 20px;
            border: 1px solid #888;
            width: 80%; 
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }
        #fetchTransactions {
    background:#0056b3 ; ;
    color: white;              
    padding: 10px 20px;         
    border: none;               
    border-radius: 5px;         
    cursor: pointer;           
    font-size: 16px;            
    transition: background-color 0.3s ease; 
}

#fetchTransactions:hover {
    background-color: #45a049;  /* Darker green on hover */
}
.date-range-selection {
    margin: 20px 0;
    display: flex;
    align-items: center;
}

.date-range-selection label {
    margin-right: 10px;
}

.date-range-selection input {
    margin-right: 20px;
    padding: 5px;
}

#generateStatementButton {
    background-color: #4CAF50; /* Green */
    border: none;
    color: white;
    padding: 10px 20px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 16px;
    margin: 10px 2px;
    cursor: pointer;
    border-radius: 5px;
    transition: background-color 0.3s;
}

#generateStatementButton:hover {
    background-color: #45a049;
}

    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
    <header class="header">
        <img src="logo.png" alt="Ideal Bank Logo">
        <div class="date-time">
            <p>
                <img src="calendar.png" alt="Calendar Icon">
                <span id="date"></span>
            </p>
            <p>
                <img src="clock.png" alt="Clock Icon">
                <span id="time"></span>
            </p>
        </div>
        <div class="profile-actions">
            <button onclick="showProfile()">
                <img src="profile.png" alt="Profile Icon"> Profile
            </button>
            <button onclick="logout()">
                <img src="logout.png" alt="Logout Icon"> Logout
            </button>
        </div>
    </header>

    <div class="marquee">
        <span id="marqueeText">Welcome to Ideal Bank - Your Trusted Partner in Banking!</span>
    </div>
    <div class="main-content">
        <div class="button-row">
            <button onclick="openFundTransfers()">Fund Transfers</button>
            <button onclick="openBillPayments()">Bill Payments & Recharges</button>
            <button onclick="openPassbook()">Passbook</button>
            <button onclick="openFD()">Fixed Deposits</button>
            <button onclick="openLoanManagement()">Loan Management</button>
            <button onclick="openAccountClosure()">Account Closure</button>
        </div>
        


        <!-- Bill Payments Section -->

<div class="bill-payments" id="billPaymentsSection" style="display: none;">
    <h2>Bill Payments & Recharges</h2>
    <div class="bill-payment-options">
        <button id="electricityBillButton">Electricity Bill</button>
        <button id="waterBillButton">Water Bill</button>
        <button id="lpgBillButton">LPG Bill</button>
        <button id="mobileRechargeButton">Mobile Recharge</button>
    </div>
</div>
<!-- Add the Loan Management form container element -->
<div class="loan-mgmt-form" id="loanMgmtFormContainer" style="display: none;">
    <h2>Loan Management</h2>
    <form>
        <!-- Button to check previous applied loans -->
        <button id="checkPreviousLoans" onclick="checkPreviousLoans()">Check Previous Applied Loans</button>
        <br><br>

        <!-- Loan type dropdown -->
        <label for="loanType">Loan Type:</label>
        <select id="loanType" name="loanType">
            <!-- Scroll options for loan types -->
            <option value="">Select Loan Type</option>
            <option value="Personal Loan">Personal Loan</option>
            <option value="Home Loan">Home Loan</option>
            <option value="Car Loan">Car Loan</option>
            <!-- Add more options as needed -->
        </select>
        <br><br>

        <!-- Amount input field -->
        <label for="amount">Amount:</label>
        <input type="number" id="amount" name="amount" />
        <br><br>

        <!-- Tenure input field -->
        <label for="tenure">Tenure:</label>
        <input type="number" id="tenure" name="tenure" />
        <br><br>

        <!-- Submit button -->
        <button id="submitLoan" onclick="submitLoan()">Submit</button>
    </form>
</div>

<!-- Account Closure Form -->
<div class="account-closure-form" id="accountClosureFormContainer">
    <h2>Account Closure</h2>
    <form>
        <label for="reason">Reason for Closure:</label>
        <textarea id="reason" name="reason"></textarea>
        <button id="closeAccountButton" onclick="closeAccount()">Close Account</button>
    </form>

    <!-- Confirmation Dialog -->
    <div class="confirmation-dialog" id="confirmationDialog">
        <h2>Confirm Account Closure</h2>
        <p>Are you sure you want to close your account?</p>
        <button id="confirmButton" onclick="confirmAccountClosure()">Yes, Close Account</button>
        <button id="cancelButton" onclick="cancelAccountClosure()">Cancel</button>
    </div>

    <!-- Transfer Details Form -->
    <div class="transfer-details-form" id="transferDetailsFormContainer">
        <h2>Transfer Details</h2>
        <form>
            <label for="newAccountNumber">New Account Number:</label>
            <input type="text" id="newAccountNumber" name="newAccountNumber" />
            <label for="newAccountName">New Account Name:</label>
            <input type="text" id="newAccountName" name="newAccountName" />
        </form>
    </div>
</div>
<!-- Add the FD form container element -->
<div class="fd-form" id="fdFormContainer" style="display: none;">
    <h2>Fixed Deposit</h2>
    <form>
        <label for="fdName">Name of FD:</label>
        <select id="fdName" name="fdName">
            <!-- Scroll options for FD names -->
            <option value="">Select FD Name</option>
            <option value="FD 1">FD 1</option>
            <option value="FD 2">FD 2</option>
            <option value="FD 3">FD 3</option>
            <!-- Add more options as needed -->
        </select>
        <label for="amount">Amount:</label>
        <input type="number" id="amount" name="amount" />
        <label for="age">Age:</label>
        <input type="number" id="age" name="age" />
        <label for="tenure">Tenure:</label>
        <input type="number" id="tenure" name="tenure" />
        <label for="roi">Rate of Interest (ROI):</label>
        <input type="number" id="roi" name="roi" />
        <button id="submitFD" onclick="submitFD()">Submit</button>
    </form>

    <!-- Button to check previous FDs -->
    <button id="checkPreviousFD" onclick="checkPreviousFD()">Check Previous FDs</button>
</div>


    <!-- Passbook Table -->
<div class="passbook-table" id="passbookTableContainer">
    <h2>Passbook</h2>
    <div>
        <label for="customerId">Customer ID:</label>
        <input type="text" id="customerId" placeholder="Enter Customer ID" disabled>
        <button id="fetchTransactions" onclick="fetchTransactions()">Fetch Transactions</button>
    </div>

    <table id="passbookTable">
        <thead>
            <tr>
                <th>Date</th>
                <th>Particulars</th>
                <th>Amount</th>
                <th>Balance After</th>
            </tr>
        </thead>
        <tbody id="passbookTableBody">
            <!-- Table data will be displayed here -->
        </tbody>
    </table>

    <!-- Date Range Selection -->
    <div class="date-range-selection">
        <label for="startDate">Start Date:</label>
        <input type="date" id="startDate" />
        <label for="endDate">End Date:</label>
        <input type="date" id="endDate" />
        <button id="generateStatementButton" onclick="generateStatement()">Generate Statement</button>
    </div>
</div>




<!-- Fund Transfer Panel -->
  <div class="fund-transfer" id="fundTransferPanel">
    <h2>Fund Transfer Options</h2>
    <div class="fund-transfer-options">
        <button id="impsButton" onclick="openImps()">IMPS(MOBILE)</button>
        <button id="rtgsButton" onclick="openRTGS()">RTGS (More than 2 Lakhs)</button>
        <button id="neftButton" onclick="openNEFT()">NEFT</button>
        <button id="ddButton" onclick="openDD()">Demand Draft (DD)</button>
       
    </div>
   <!-- Transfer Form (Initially hidden) -->
  


  <!-- IMPS Transfer Form -->
  <div class="imps-form" id="impsForm">
      <h2>IMPS Transfer Form</h2>
      <table>
          <tr>
              <th>Mobile Number</th>
              <td><input type="text" id="mobileNumberImps" placeholder="Enter mobile number for IMPS"></td>
          </tr>
          <tr>
              <th>Amount</th>
              <td><input type="number" id="amountImps" placeholder="Enter amount"></td>
          </tr>
      </table>
      <p class="form-info">For IMPS, the amount must be greater than 0.</p>

      <button id="sendImpsButton" onclick="sendImps()">Send IMPS</button>

      <!-- Error message for IMPS validation -->
      <div class="error-message" id="impsError" style="display: none;">Amount must be greater than 0 for IMPS transfers.</div>
  </div>

<!-- RTGS Transfer Form -->
<div class="transfer-form rtgs-form" id="rtgsForm">
    <label for="accNoRTGS">Account Number</label>
    <input type="text" id="accNoRTGS" placeholder="Enter account number for RTGS">

    <label for="customerNameRTGS">Customer Name</label>
    <input type="text" id="customerNameRTGS" placeholder="Enter customer name">

    <label for="accTypeRTGS">Account Type</label>
    <select id="accTypeRTGS">
        <option value="savings">Savings</option>
        <option value="current">Current</option>
    </select>

    <label for="particularsRTGS">Particulars</label>
    <input type="text" id="particularsRTGS" placeholder="Enter particulars">

    <label for="amountRTGS">Amount (Minimum 2,00,000)</label>
    <input type="number" id="amountRTGS" placeholder="Enter amount">

    <p class="form-info">For RTGS, the amount must be greater than 2,00,000.</p>

    <button id="sendRTGSButton" onclick="sendRTGS()">Send RTGS</button>

    <!-- Error message for RTGS validation -->
    <div class="error-message" id="rtgsError" style="display: none;">Amount must be greater than 2,00,000 for RTGS transfers.</div>
</div>


<!-- NEFT Transfer Form -->
<div class="transfer-form neft-form" id="neftForm">
    <label for="destAccNoNEFT">Account Number</label>
    <input type="text" id="destAccNoNEFT" placeholder="Enter account number for NEFT">

    <label for="customerNameNEFT">Customer Name</label>
    <input type="text" id="customerNameNEFT" placeholder="Enter customer name">

    <label for="accTypeNEFT">Account Type</label>
    <select id="accTypeNEFT">
        <option value="savings">Savings</option>
        <option value="current">Current</option>
    </select>

    <label for="particularsNEFT">Particulars</label>
    <input type="text" id="particularsNEFT" placeholder="Enter particulars">

    <label for="amountNEFT">Amount</label>
    <input type="number" id="amountNEFT" placeholder="Enter amount">

    <p class="form-info">NEFT allows any amount to be transferred less than 2 Lakhs.</p>

    <button id="sendNEFTButton" onclick="sendNEFT()">Send NEFT</button>

    <!-- Error message for NEFT validation -->
    <div class="error-message" id="neftError" style="display: none;">Amount must be less than 2,00,000 for NEFT transfers.</div>
</div>
<!-- Demand Draft Form (Initially hidden) -->
<div class="transfer-form dd-form" id="ddForm">
    <h2>Demand Draft Form</h2>
    <label for="payeeName">Payee Name</label>
    <input type="text" id="payeeName" placeholder="Enter payee name">

    <label for="ddAmount">Amount</label>
    <input type="number" id="ddAmount" placeholder="Enter amount">
    
    <p class="form-info">Charges as per applicable:
        <br>Amounts between Rs 10,000 and Rs 20,000: Rs 100
        <br>Amounts between Rs 20,000 and Rs 50,000: Rs 200
        <br> Amounts between Rs 50,000 and Rs 1,00,000: Rs 300
        <br> Amounts between Rs 1,00,000 and Rs 2,00,000: Rs 500
        <br> Amounts above Rs 2,00,000: Rs 700
    </p>
    <P><b>dd is not for less than Rs10,000</b></P>

    <p><b>Note:After transaction successful message visit branch ,give your account number/or show downloaded dd pdf  and collect reciept without queue </b></p>

    <button id="processDDButton" class="dd-button" onclick="processDD()">Proceed</button>
     <!-- Modal -->
<div id="ddModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal()">&times;</span>
        <h2>Success!</h2>
        <p>Your Demand Draft has been successfully processed!</p>
        <p><strong>Reference Number:</strong> <span id="modalReferenceNumber"></span></p>
        <p>Visit the nearest branch with this reference number to collect your Demand Draft without standing in a queue.</p>
    </div>
</div>

</div>
</div>

      

    <div class="container">
        <div class="profile-info" id="profileInfo">
            <h1>Profile Information</h1>
            <div class="profile-tables">
                <div class="table-container">
                    <table>
                        <tr>
                            <th>Name</th>
                            <td><input type="text" id="name" readonly></td>
                        </tr>
                        <tr>
                            <th>Date of Birth</th>
                            <td><input type="text" id="dob" readonly></td>
                        </tr>
                        <tr>
                            <th>Gender</th>
                            <td><input type="text" id="gender" readonly></td>
                        </tr>
                        <tr>
                            <th>Aadhar</th>
                            <td><input type="text" id="aadhar" readonly></td>
                        </tr>
                        <tr>
                            <th>PAN</th>
                            <td><input type="text" id="pan" readonly></td>
                        </tr>
                        <tr>
                            <th>Joint Name</th>
                            <td><input type="text" id="jointName" readonly></td>
                        </tr>
                        <tr>
                            <th>Joint Date of Birth</th>
                            <td><input type="text" id="jointDob" readonly></td>
                        </tr>
                        <tr>
                            <th>Joint Gender</th>
                            <td><input type="text" id="jointGender" readonly></td>
                        </tr>
                        <tr>
                            <th>Joint Aadhar</th>
                            <td><input type="text" id="jointAadhar" readonly></td>
                        </tr>
                        <tr>
                            <th>Joint PAN</th>
                            <td><input type="text" id="jointPan" readonly></td>
                        </tr>
                    </table>
                </div>
                <div class="table-container">
                    <table>
                        <tr>
                            <th>Account Type</th>
                            <td><input type="text" id="accountType" readonly></td>
                        </tr>
                        <tr>
                            <th>Address</th>
                            <td><input type="text" id="address" readonly></td>
                        </tr>
                        <tr>
                            <th>Email</th>
                            <td><input type="text" id="email" readonly></td>
                        </tr>
                  
                        <tr>
                            <th>Mobile Number</th>
                            <td><input type="text" id="mobileNumber" readonly></td>
                        </tr>
                        <tr>
                            <th>Operation Mode</th>
                            <td><input type="text" id="operationMode" readonly></td>
                        </tr>
                        <tr>
                            <th>Account Type Detail</th>
                            <td><input type="text" id="accountTypeDetail" readonly></td>
                        </tr>
                        <tr>
                            <th>Account Number</th>
                            <td><input type="text" id="accountNumber" readonly></td>
                        </tr>
                        <tr>
                            <th>Customer ID</th>
                        <td><input type="text" id="customerIdProfile" readonly></td> <!-- Updated ID to prevent conflict -->
                        </tr>
                        <tr>
                            <th>Account Opening Date</th>
                            <td><input type="text" id="accOpeningDate" readonly></td>
                        </tr>
                    </table>
                </div>
            </div>
            <div class="btn-container">
                <button onclick="hideProfile()">Back</button>
            </div>
        </div>
    </div>
    

    <footer class="footer">
        &copy; 2024 Ideal Bank. All Rights Reserved.
    </footer>

    <script>
        function logout() {
            localStorage.removeItem('username');
            window.location.href = 'index.html';
        }

        function showProfile() {
            document.getElementById('profileInfo').style.display = 'block';
    document.getElementById('fundTransferPanel').style.display = 'none';
    document.getElementById('rtgsForm').style.display = 'none';
    document.getElementById('neftForm').style.display = 'none';
    document.getElementById('ddForm').style.display = 'none';
            document.getElementById('profileInfo').style.display = 'block';
            document.getElementById('billPaymentsSection').style.display = 'none';
            const passbookTableContainer = document.getElementById('passbookTableContainer');
    passbookTableContainer.style.display = 'none';
    document.getElementById('fdFormContainer').style.display = 'none';
    const accountClosureFormContainer = document.getElementById('accountClosureFormContainer');
    accountClosureFormContainer.style.display = 'none';
    loanMgmtFormContainer.style.display = "none";




            const username = localStorage.getItem('username');
            if (username) {
                fetch(`http://localhost:3001/dashboard?username=${username}`)
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            const user = data.user;
                            document.getElementById('name').value = user.name;
                            document.getElementById('dob').value = formatDate(user.dob);  
                            document.getElementById('gender').value = user.gender;
                            document.getElementById('aadhar').value = user.aadhar;
                            document.getElementById('pan').value = user.pan;
                            document.getElementById('jointName').value = user.joint_name;
                            document.getElementById('jointDob').value = formatDate(user.joint_dob); 
                            document.getElementById('jointGender').value = user.joint_gender;
                            document.getElementById('jointAadhar').value = user.joint_aadhar;
                            document.getElementById('jointPan').value = user.joint_pan;
                            document.getElementById('accountType').value = user.account_type;
                            document.getElementById('address').value = user.address;
                            document.getElementById('email').value = user.email;
                            document.getElementById('operationMode').value = user.operation_mode;
                            document.getElementById('accountTypeDetail').value = user.account_type_detail;
                            document.getElementById('accountNumber').value = user.account_number;
                            document.getElementById('customerIdProfile').value = user.customer_id;
                            document.getElementById('accOpeningDate').value = formatDate(user.acc_opening_date);
                         
                            document.getElementById('mobileNumber').value = user.mobile_number;
                        } else {
                            console.log('Error fetching profile data:', data.error);
                        }
                    })
                    .catch(error => console.error('Error:', error));
            }
        }
        function formatDate(dateString) {
    if (dateString === null || dateString === 'NULL') {
        return 'Not Available';
    } else {
        const date = new Date(dateString);
        const year = date.getFullYear();
        const month = ('0' + (date.getMonth() + 1)).slice(-2);  // Ensure 2 digits for month
        const day = ('0' + date.getDate()).slice(-2);  // Ensure 2 digits for day
        return `${year}-${month}-${day}`;  // Returning formatted date as YYYY-MM-DD
    }
}
function hideProfile() {
    document.getElementById('profileInfo').style.display = 'none'; // Hide profile section
    document.getElementById('fundTransferPanel').style.display = 'none'; // Show fund transfer panel
    // Show other sections as needed
}
        function displayDateTime() {
            const now = new Date();
            const date = now.toLocaleDateString();
            const time = now.toLocaleTimeString();
            document.getElementById('date').textContent = `Date: ${date}`;
            document.getElementById('time').textContent = `Time: ${time}`;
        }

        setInterval(displayDateTime, 1000);

        let transferType = ''; // To keep track of the selected transfer type

function openFundTransfers() {
    document.getElementById('fundTransferPanel').style.display = 'block'; // Show fund transfer panel
    document.getElementById('rtgsForm').style.display = 'none'; // Hide both forms initially
    document.getElementById('neftForm').style.display = 'none';
    document.getElementById('profileInfo').style.display = 'none'; // Hide Profile section
    document.getElementById('billPaymentsSection').style.display = 'none';
    const passbookTableContainer = document.getElementById('passbookTableContainer');
    passbookTableContainer.style.display = 'none';
    document.getElementById('fdFormContainer').style.display = 'none';
    const accountClosureFormContainer = document.getElementById('accountClosureFormContainer');
    accountClosureFormContainer.style.display = 'none';
    document.getElementById('impsForm').style.display = 'none';

}

function hideOtherForms() {
    document.getElementById('rtgsForm').style.display = 'none';
    document.getElementById('neftForm').style.display = 'none';
    document.getElementById('ddForm').style.display = 'none';
    document.getElementById('impsForm').style.display = 'none';
    document.getElementById('profileInfo').style.display = 'none';
}

// Function to go back to the main options
function backToMain() {
    document.getElementById('upiIDGeneration').style.display = 'none';
    document.getElementById('upiSendMoneySection').style.display = 'none';
    document.getElementById('upiMainButtons').style.display = 'block';
    document.getElementById('generateUPIButton').disabled = false; // Re-enable the button
}

function openRTGS() {
    alert('RTGS is only available for amounts over 2,00,000.'); // Pop-up alert for RTGS
    transferType = 'RTGS';
    document.getElementById('rtgsForm').style.display = 'block'; // Show RTGS form
    document.getElementById('neftForm').style.display = 'none'; // Hide NEFT form
    document.getElementById('ddForm').style.display = 'none'; // Hide DD form
    document.getElementById('profileInfo').style.display = 'none'; // Hide Profile section
    document.getElementById('impsForm').style.display = 'none'; // Hide UPI form
   

    hideUPIButtons();

    resetForm('rtgs'); // Reset RTGS form
}



function openNEFT() {
    transferType = 'NEFT';
    document.getElementById('rtgsForm').style.display = 'none'; // Hide RTGS form
    document.getElementById('neftForm').style.display = 'block'; // Show NEFT form
    document.getElementById('ddForm').style.display = 'none'; // Hide DD form
    document.getElementById('profileInfo').style.display = 'none'; // Hide Profile section
    document.getElementById('impsForm').style.display = 'none'; // Hide UPI form
    
    hideUPIButtons();

    resetForm('neft'); // Reset NEFT form
}

// Function to send RTGS request
function sendRTGS() {
    const username = localStorage.getItem('username');
    const button = document.getElementById('sendRTGSButton');
    button.disabled = true; // Disable button

    if (username) {
        fetch(`http://localhost:3001/dashboard?username=${username}`)
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    const user = data.user;
                    const scaccountnumber = user.account_number;
                    const destinationAccountNumber = document.getElementById("accNoRTGS").value;
                    const amount = parseFloat(document.getElementById("amountRTGS").value);

                    // Validate amount for RTGS
                    if (amount < 200000) {
                        document.getElementById("rtgsError").style.display = "block";
                        return;
                    }
                    document.getElementById("rtgsError").style.display = "none";

                    // Send RTGS request to the server
                    fetch('http://localhost:3001/transfer/rtgs', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ scaccountnumber, destinationAccountNumber, amount })
                    })
                    .then(response => response.json())
                    .then(data => alert(data.message))
                    .catch(error => console.error('Error:', error));
                } else {
                    console.log('Error fetching profile data:', data.error);
                }
            });
    } else {
        console.log('No username found in localStorage.');
        button.disabled = false; // Enable button
    }
}

// Function to send NEFT request
function sendNEFT() {
    const username = localStorage.getItem('username');
    const button = document.getElementById('sendNEFTButton');
    button.disabled = true; // Disable button

    if (username) {
        fetch(`http://localhost:3001/dashboard?username=${username}`)
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    const user = data.user;
                    const scaccountnumber = user.account_number;
                    const destinationAccountNumber = document.getElementById("destAccNoNEFT").value;
                    const amount = parseFloat(document.getElementById("amountNEFT").value);

                    // Validate amount for NEFT
                    if (amount >= 200000) {
                        document.getElementById("neftError").style.display = "block";
                        return;
                    }
                    document.getElementById("neftError").style.display = "none";

                    // Send NEFT request to the server
                    fetch('http://localhost:3001/transfer/neft', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ scaccountnumber, destinationAccountNumber, amount })
                    })
                    .then(response => response.json())
                    .then(data => alert(data.message))
                    .catch(error => console.error('Error:', error));
                } else {
                    console.log('Error fetching profile data:', data.error);
                }
            });
    } else {
        console.log('No username found in localStorage.');
        button.disabled = false; // Enable button

    }
}

// Open the IMPS Transfer form
function openImps() {
    // Set the transfer type to IMPS
    const transferType = 'IMPS';
    
    // Show the IMPS form and hide other forms if necessary
    document.getElementById('impsForm').style.display = 'block'; // Show IMPS form
    document.getElementById('rtgsForm').style.display = 'none'; // Hide RTGS form
    document.getElementById('neftForm').style.display = 'none'; // Show NEFT form
    document.getElementById('ddForm').style.display = 'none'; // Hide DD form
    document.getElementById('profileInfo').style.display = 'none'; // Hide Profile section


    
    // Reset the IMPS form
    resetForm('imps');
}

// Reset the form fields
function resetForm(type) {
    if (type === 'imps') {
        document.getElementById('mobileNumberImps').value = '';  // Reset mobile number field
        document.getElementById('amountImps').value = '';  // Reset amount field
        document.getElementById('impsError').style.display = 'none'; // Hide error message
    }
}

// Function to send IMPS request
function sendImps() {
    const button = document.getElementById('sendImpsButton');
    button.disabled = true; // Disable the button to prevent multiple clicks

    // Retrieve the username from localStorage (or another method of user session management)
    const username = localStorage.getItem('username');

    if (username) {
        // Fetch user profile to get source account number
        fetch(`http://localhost:3001/dashboard?username=${username}`)
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    const user = data.user;
                    const scaccountnumber = user.account_number;  // Get source account number
                    const mobileNumber = document.getElementById("mobileNumberImps").value;  // Get mobile number from form
                    const amount = parseFloat(document.getElementById("amountImps").value);  // Get amount from form

                    // Validate amount for IMPS
                    if (amount <= 0) {
                        document.getElementById("impsError").style.display = "block";  // Show error if amount is invalid
                        button.disabled = false;  // Re-enable button
                        return;
                    }
                    document.getElementById("impsError").style.display = "none";  // Hide error message

                    // Send IMPS request to the backend
                    fetch('http://localhost:3001/transfer/imps', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ scaccountnumber, mobileNumber, amount })
                    })
                    .then(response => response.json())
                    .then(data => {
                        alert(data.message);  // Show success message
                        button.disabled = false;  // Re-enable the button
                    })
                    .catch(error => {
                        console.error('Error:', error);
                        button.disabled = false;  // Re-enable the button on error
                    });
                } else {
                    console.log('Error fetching profile data:', data.error);
                    button.disabled = false;  // Re-enable the button
                }
            });
    } else {
        console.log('No username found in localStorage.');
        button.disabled = false;  // Re-enable the button
    }
}


function openBillPayments() {
    document.getElementById('fundTransferPanel').style.display = 'none';
    document.getElementById('billPaymentsSection').style.display = 'block';
    document.getElementById('profileInfo').style.display = 'none'; // Hide Profile section
    const passbookTableContainer = document.getElementById('passbookTableContainer');
    passbookTableContainer.style.display = 'none';
    document.getElementById('fdFormContainer').style.display = 'none';
    const accountClosureFormContainer = document.getElementById('accountClosureFormContainer');
    accountClosureFormContainer.style.display = 'none';
    loanMgmtFormContainer.style.display = "none";
    
  
    // Hide other sections as needed
}
document.getElementById('electricityBillButton').addEventListener('click', function() {
    // Handle electricity bill payment
});

document.getElementById('waterBillButton').addEventListener('click', function() {
    // Handle water bill payment
});

document.getElementById('lpgBillButton').addEventListener('click', function() {
    // Handle LPG bill payment
});

document.getElementById('mobileRechargeButton').addEventListener('click', function() {
    // Handle mobile recharge
});
function resetForm(type) {
    if (type === 'rtgs') {
        document.getElementById('accNoRTGS').value = '';
        document.getElementById('customerNameRTGS').value = '';
        document.getElementById('accTypeRTGS').value = '';
        document.getElementById('particularsRTGS').value = '';
        document.getElementById('amountRTGS').value = '';
        document.getElementById('rtgsError').style.display = 'none'; // Hide RTGS error message
    } else if (type === 'neft') {
        document.getElementById('accNoNEFT').value = '';
        document.getElementById('customerNameNEFT').value = '';
        document.getElementById('accTypeNEFT').value = '';
        document.getElementById('particularsNEFT').value = '';
        document.getElementById('amountNEFT').value = '';
    }
}





// Placeholder functions for other transfer types


function openDD() {
    transferType = 'DD';
    document.getElementById('ddForm').style.display = 'block'; // Show DD form
    document.getElementById('rtgsForm').style.display = 'none'; // Hide RTGS form
    document.getElementById('neftForm').style.display = 'none'; // Hide NEFT form
    document.getElementById('impsForm').style.display = 'none'; // Hide UPI form
    
    hideUPIButtons();


    resetForm('dd'); // Reset DD form
}
function resetForm(type) {
    if (type === 'dd') {
        document.getElementById('payeeName').value = '';
        document.getElementById('ddAmount').value = '';
        document.getElementById('ddResult').style.display = 'none'; // Hide DD result
    }
}

async function processDD() {
    const username = localStorage.getItem('username');
    const payeeName = document.getElementById('payeeName').value;
    const amount = parseFloat(document.getElementById('ddAmount').value);
    
    const button = document.getElementById('processDDButton');
    const referenceNumber = Math.floor(Math.random() * 1000000000); // Random 9-digit number
  

    // Disable button after click to avoid multiple submissions
    button.disabled = true;

    // Validation
    if (!payeeName || isNaN(amount) || amount <= 0) {
        alert('Please fill in all fields correctly.');
        button.disabled = false; // Re-enable the button
        return;
    }

    if (username) {
        try {
            // Fetch user account details using the username
            const userResponse = await fetch(`http://localhost:3001/dashboard?username=${username}`);
            const userData = await userResponse.json();

            if (userData.success) {
                const user = userData.user;
                const sourceAccountNumber = user.account_number;  // Extract the source account number from user data

                let charges = 0;
                // Charge calculation logic
                if (amount < 10000) {
                    alert('Demand Draft amount must be at least Rs 10,000.');
                    button.disabled = false;
                    return;
                } else if (amount <= 20000) {
                    charges = 100;
                } else if (amount <= 50000) {
                    charges = 200;
                } else if (amount <= 100000) {
                    charges = 300;
                } else if (amount <= 200000) {
                    charges = 500;
                } else {
                    charges = 700;
                }

                const totalAmount = amount + charges;

                // Proceed with the DD transfer
                const ddResponse = await fetch('http://localhost:3001/transfer/dd', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ payeeName, amount, charges, totalAmount, referenceNumber, sourceAccountNumber })
                });
                const ddData = await ddResponse.json();

                if (ddData.success) {
                     // Check if the element exists before setting the content
                     const referenceNumberElement = document.getElementById('referenceNumber');
                    if (referenceNumberElement) {
                        referenceNumberElement.textContent = `Reference Number: ${referenceNumber}`;
                    } else {
                        console.warn('Reference number element not found!');
                    }
                    
                    // Show the modal
                    document.getElementById('modalReferenceNumber').textContent = referenceNumber;
                    document.getElementById('ddModal').style.display = 'block'; // Show modal
                    
                } else {
                    alert(`Error: ${ddData.message}`);  // Display detailed error message
                    console.error('Backend error:', ddData.error);  // Log the actual error
                }
            } else {
                alert('Error fetching user data.');
            }
        } catch (error) {
            console.error('Error:', error);
        } finally {
            button.disabled = false;  // Always re-enable the button after processing
        }
    }
}
function closeModal() {
    document.getElementById('ddModal').style.display = 'none';
}

// Function to generate PDF
/*function generatePDF(referenceNumber, amount, payeeName) {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();
    const today = new Date().toLocaleDateString();

    doc.text('Demand Draft Details', 10, 10);
    doc.text(`Reference Number: ${referenceNumber}`, 10, 20);
    doc.text(`Amount: Rs ${amount}`, 10, 30);
    doc.text(`Payee Name: ${payeeName}`, 10, 40);
    doc.text(`Date: ${today}`, 10, 50);

    doc.save(`Demand_Draft_${referenceNumber}.pdf`);
}*/

function openPassbook() {
    const passbookTableContainer = document.getElementById('passbookTableContainer');
    passbookTableContainer.style.display = 'block';
    document.getElementById('fundTransferPanel').style.display = 'none';
    document.getElementById('profileInfo').style.display = 'none'; // Hide Profile section
    document.getElementById('billPaymentsSection').style.display = 'none';
    document.getElementById('fdFormContainer').style.display = 'none';
    const accountClosureFormContainer = document.getElementById('accountClosureFormContainer');
    accountClosureFormContainer.style.display = 'none';
    loanMgmtFormContainer.style.display = "none";
}

// Function to fetch transactions and populate the passbook table
function fetchTransactions() {
    const username = localStorage.getItem('username');
    
    // Fetch user data based on username
    fetch(`http://localhost:3001/dashboard?username=${username}`)
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                const user = data.user;
                const customerId = user.customer_id; // Get customer ID from user data
                
                // Set the customer ID in the passbook input field
                document.getElementById('customerId').value = customerId;

                // Fetch transactions from the database using customer ID
                fetch(`http://localhost:3001/transactions?customer_id=${customerId}`)
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            const transactions = data.transactions;
                            const passbookTableBody = document.getElementById('passbookTableBody');

                            // Clear the table body
                            passbookTableBody.innerHTML = '';

                            // Populate the table body with transactions
                            transactions.forEach(transaction => {
                                const row = document.createElement('tr');
                                row.innerHTML = `
                                    <td>${new Date(transaction.date).toLocaleDateString()}</td> <!-- Formatting date to readable format -->
                                    <td>${transaction.particulars}</td>
                                    <td>${transaction.amount > 0 ? `Credit: ${transaction.amount}` : `Debit: ${Math.abs(transaction.amount)}`}</td>
                                    <td>${transaction.balance_after}</td>
                                `;
                                passbookTableBody.appendChild(row);
                            });
                        } else {
                            console.log('Error fetching transactions:', data.error);
                        }
                    })
                    .catch(error => console.error('Error:', error));
            } else {
                console.log('Error fetching user data:', data.error);
            }
        })
        .catch(error => console.error('Error:', error));
}

document.getElementById('fetchTransactions').addEventListener('click', fetchTransactions);
function generateStatement() {
    // Get username from localStorage
    const username = localStorage.getItem('username');

    // Fetch user data based on username to get customer ID
    fetch(`http://localhost:3001/dashboard?username=${username}`)
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                const user = data.user;
                const customerId = user.customer_id; // Get customer ID from user data

                const startDate = document.getElementById('startDate').value;
                const endDate = document.getElementById('endDate').value;

                // Check if customer_id exists
                if (!customerId) {
                    alert("Customer ID not found!");
                    return;
                }

                // Check if both startDate and endDate are selected
                if (!startDate || !endDate) {
                    alert("Please select a valid start date and end date.");
                    return;
                }

                // Build the URL with the customer ID and date range
                const url = `http://localhost:3001/generateStatement?customer_id=${customerId}&startDate=${startDate}&endDate=${endDate}`;

                // Fetch the transactions within the date range
                fetch(url)
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Network response was not ok');
                        }
                        return response.json();
                    })
                    .then(data => {
                        if (data.success) {
                            const transactions = data.transactions;
                            const passbookTableBody = document.getElementById('passbookTableBody');

                            // Clear the table body before inserting new data
                            passbookTableBody.innerHTML = '';

                            // Populate the table body with fetched transactions
                            transactions.forEach(transaction => {
                                const row = document.createElement('tr');
                                row.innerHTML = `
                                    <td>${new Date(transaction.date).toLocaleDateString()}</td>
                                    <td>${transaction.particulars}</td>
                                    <td>${transaction.amount > 0 ? `Credit: ${transaction.amount}` : `Debit: ${Math.abs(transaction.amount)}`}</td>
                                    <td>${transaction.balance_after}</td>
                                `;
                                passbookTableBody.appendChild(row);
                            });
                        } else {
                            console.error('Error generating statement:', data.error);
                        }
                    })
                    .catch(error => {
                        console.error('Error fetching data:', error);
                        alert('An error occurred while generating the statement. Please try again later.');
                    });
            } else {
                console.log('Error fetching user data:', data.error);
            }
        })
        .catch(error => console.error('Error:', error));
}

// Attach the function to the Generate Statement button
document.getElementById('generateStatementButton').addEventListener('click', generateStatement);

function openAccountClosure() {
    const accountClosureFormContainer = document.getElementById('accountClosureFormContainer');
    accountClosureFormContainer.style.display = 'block';
}
function closeAccount() {
    const confirmationDialog = document.getElementById('confirmationDialog');
    confirmationDialog.style.display = 'block';
}
function openFD() {
    document.getElementById('fdFormContainer').style.display = 'block';
    document.getElementById('fundTransferPanel').style.display = 'none';
    document.getElementById('profileInfo').style.display = 'none'; // Hide Profile section
    document.getElementById('billPaymentsSection').style.display = 'none';
    const passbookTableContainer = document.getElementById('passbookTableContainer');
    passbookTableContainer.style.display = 'none';
    const accountClosureFormContainer = document.getElementById('accountClosureFormContainer');
    accountClosureFormContainer.style.display = 'none';
    loanMgmtFormContainer.style.display = "none";

    // Hide other sections as needed
}
function openAccountClosure() {
    const accountClosureFormContainer = document.getElementById('accountClosureFormContainer');
    accountClosureFormContainer.style.display = 'block';
    document.getElementById('fundTransferPanel').style.display = 'none';
    document.getElementById('profileInfo').style.display = 'none'; // Hide Profile section
    document.getElementById('billPaymentsSection').style.display = 'none';
    const passbookTableContainer = document.getElementById('passbookTableContainer');
    passbookTableContainer.style.display = 'none';
    document.getElementById('fdFormContainer').style.display = 'none';
    loanMgmtFormContainer.style.display = "none";

}
// Function to open the Loan Management form
function openLoanManagement() {
    // Get the Loan Management form container element
    var loanMgmtFormContainer = document.getElementById("loanMgmtFormContainer");

    // Show the Loan Management form
    loanMgmtFormContainer.style.display = "block";
    document.getElementById('fundTransferPanel').style.display = 'none';
    document.getElementById('profileInfo').style.display = 'none'; // Hide Profile section
    document.getElementById('billPaymentsSection').style.display = 'none';
    const passbookTableContainer = document.getElementById('passbookTableContainer');
    passbookTableContainer.style.display = 'none';
    document.getElementById('fdFormContainer').style.display = 'none';
    const accountClosureFormContainer = document.getElementById('accountClosureFormContainer');
    accountClosureFormContainer.style.display = 'none';

}

// Function to check previous applied loans
function checkPreviousLoans() {
    // TO DO: Implement logic to check previous applied loans
    console.log("Checking previous applied loans...");
}

// Function to submit loan application
function submitLoan() {
    // Get the loan type, amount, and tenure from the form
    var loanType = document.getElementById("loanType").value;
    var amount = document.getElementById("amount").value;
    var tenure = document.getElementById("tenure").value;

    // TO DO: Implement logic to submit loan application
    console.log("Submitting loan application...");
    console.log("Loan Type: " + loanType);
    console.log("Amount: " + amount);
    console.log("Tenure: " + tenure);
}
      
        window.onload = function() {
            document.getElementById('fdFormContainer').style.display = 'none';
            const passbookTableContainer = document.getElementById('passbookTableContainer');
    passbookTableContainer.style.display = 'none';
    document.getElementById('billPaymentsSection').style.display = 'none';
    document.getElementById('fundTransferPanel').style.display = 'none';
    const accountClosureFormContainer = document.getElementById('accountClosureFormContainer');
    accountClosureFormContainer.style.display = 'none';
    loanMgmtFormContainer.style.display = "none";

            const username = localStorage.getItem('username');
            if (username) {
                fetch(`http://localhost:3001/dashboard?username=${username}`)
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            document.getElementById('marqueeText').textContent = `Welcome, ${data.user.name}! Thank you for banking with Ideal Bank!`;
                        }
                    });
            }
        };
    </script>
</body>
</html>
