<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Ideal Bank</title>
    <style>
        
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f0f0;
            text-align: center;
        }
        .header {
            background-color: #e9ecef;
            color: white;
            padding: 10px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            position: relative;
        }
        .header img {
            max-width: 200px;
        }
        .header .date-time {
            position: absolute;
            top: 10px;
            left: 10px;
            color: royalblue;
            text-align: left;
        }
        .header .date-time p {
            margin: 0;
            display: flex;
            align-items: center;
        }
        .header .date-time p img,
        .header .profile-actions button img {
            margin-right: 5px;
            width: 40px; 
            height: 40px; 
        }
        .header .profile-actions {
    position: absolute;
    top: 10px;
    right: 10px;  
    transform: translateX(-0.5cm); 
    text-align: right;
}
        .header .profile-actions button {
            background-color: #004085;
            color: white;
            border: none;
            padding: 6.5px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            display: flex;
            align-items: center;
        }
        .header .profile-actions button img {
            margin-right: 5px;
            width: 21px;
            height: 21px;
        }
        .marquee {
            background-color: #004085;
            color: white;
            padding: 10px;
            font-size: 18px;
            white-space: nowrap;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            position: relative;
            height: 40px;
            line-height: 40px;
        }
        .marquee span {
            display: inline-block;
            padding-left: 100%;
            animation: marquee 15s linear infinite;
        }
        @keyframes marquee {
            from {
                transform: translateX(0);
            }
            to {
                transform: translateX(-100%);
            }
        }
        .profilecontainer {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px;
            margin-top: -10px; /* Adjusted margin for the header */
            padding-top: 0px; /* Optional: Adjust if necessary to shift upwards */
            
        }
        .profile-info {
            background-color: #ffffff;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 1200px;
            text-align: left;
            display: none;
        }
        .profile-info h1 {
            font-size: 24px;
            margin-bottom: 5px;
            margin-top: -10px; /* Optional: Ensure the title is closer to the top */
            text-align: center; /* Center align the title */

        }
        .profile-tables {
            display: flex;
            justify-content: space-between;
            overflow-x: auto;
            overflow-x: auto;
            margin-top: 10px; /* Add some space below the title and above tables */
        }
        .profile-tables .table-container {
            width: 45%;
        }
        .profile-tables table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            table-layout: fixed;
        }
        .profile-tables table, .profile-tables th, .profile-tables td {
            border: 1px solid #ddd;
        }
        .profile-tables th, .profile-tables td {
            padding: 10px;
            text-align: left;
            white-space: nowrap; 
            overflow: hidden; 
            text-overflow: ellipsis; 
        }
        .profile-tables th {
            background-color: #f4f4f4;
            width: 30%;

        }
        .profile-tables td {
            width: 70%;
        }
        .profile-tables td input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 5px;
            box-sizing: border-box;
        }
        .btn-container {
            text-align: center;
        }
        .btn-container button {
            background-color: #004085;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
        }
        .footer {
  background-color: #004085;
  color: white;
  padding: 10px;
  text-align: center;
  position: fixed;
  width: 100%;
  bottom: 0;
  left: 0;
  margin: 0; /* Add this property */
}
        .main-content {
            margin: 20px;
        }

        .button-row {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }

        .button-row button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 15px 25px;
            margin: 0;
            border-right: 2px solid white;
            cursor: pointer;
            flex: 1;
            transition: background-color 0.3s ease;
        }

        .button-row button:hover {
            background-color: #0056b3;
        }

        .button-row button:last-child {
            border-right: none;
        }

     /* Fund Transfer Panel */
     .fund-transfer {
            background-color: #ffffff;
            padding: 20px;
            margin: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            display: none; /* Hidden initially */
            max-width: 800px;
            margin: auto; /* Center the panel */
        }

        .fund-transfer h2 {
            font-size: 24px;
            margin-bottom: 20px;
            text-align: center; /* Center align title */
        }

        /* Flexbox styling for side-by-side buttons with dynamic resizing */
        .fund-transfer-options {
            display: flex;
            flex-wrap: wrap;
            gap: 15px; /* Adds space between buttons */
            justify-content: center; /* Center the buttons */
        }

        .fund-transfer-options button {
            flex: 1 1 180px;
            max-width: 300px;
            padding: 15px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            text-align: center;
            transition: background-color 0.3s ease;
            font-size: 16px;
        }

        .fund-transfer-options button:hover {
            background-color: #0056b3;
        }

        /* Responsive layout for smaller screens */
        @media (max-width: 768px) {
            .fund-transfer-options button {
                flex: 1 1 100%;
                font-size: 14px;
            }
        }

        /* Form styles */
        
        .transfer-form {
        display: flex;
        flex-direction: column;
        gap: 10px;
        padding: 20px;
        border: 1px solid #ccc;
        border-radius: 5px;
        max-width: 500px; /* Adjust as needed */
        margin: 0 auto;
    }

    .transfer-form label {
        font-size: 1.2em;
    }

    /* Common styles for form fields */
.transfer-form input,
.transfer-form select {
    font-size: 1.2em; /* Increase font size for better visibility */
    padding: 12px; /* Increase padding for better touch */
    border: 1px solid #ddd;
    border-radius: 4px;
    width: 100%; /* Full width for each field */
    box-sizing: border-box; /* Ensure padding and border are included in total width */
    margin-bottom: 15px; /* Add space between fields */
}

/* Ensures each label is on a separate line */
.transfer-form label {
    display: block; /* Make labels block elements to ensure they are on their own line */
    font-size: 1.2em; /* Increase font size for better visibility */
    margin-bottom: 5px; /* Space between label and input */
}
/* Add styles to hide and show elements */
.upi-buttons, .upi-form, .send-money-form {
    display: none;
}

/* Styles for RTGS form */
.rtgs-form {
    display: flex;
    flex-direction: column; /* Stack fields vertically */
    gap: 15px; /* Space between fields */
    padding: 20px; /* Padding around the form */
    border: 1px solid #ccc; /* Border around the form */
    border-radius: 8px; /* Rounded corners */
    background-color: #f9f9f9; /* Light background color */
}

/* Specific styles for form description and errors */
.rtgs-form .description {
    font-size: 1em; /* Font size for instructions */
    color: #555; /* Darker color for text */
    margin-bottom: 20px; /* Space below description */
}

.rtgs-form .error {
    color: #d9534f; /* Error text color */
    font-size: 0.9em; /* Slightly smaller font size for errors */
}
.rtgs-form button, .neft-form button {
    padding: 15px 30px;
    font-size: 18px;
    border-radius: 10px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    cursor: pointer;
}

.rtgs-form button:active, .neft-form button:active {
    background-color: #004085; /* Change the background color on click */
    box-shadow: 0 0 0 rgba(0, 0, 0, 0.1); /* Remove the shadow on click */
    transform: translateY(2px); /* Add a slight movement on click */
}

/* Demand Draft Form Styles */
.dd-form {
    display: none; /* Hidden initially */
    background-color: #f9f9f9;
    padding: 20px;
    margin: 20px auto;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    max-width: 500px;
}

.dd-form h2 {
    font-size: 24px;
    margin-bottom: 20px;
    text-align: center;
}

.dd-form .form-info {
    font-size: 1em;
    color: #555;
    margin-top: 10px;
}
.dd-button {
    background-color: #007bff;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 5px;
    cursor: pointer;
    font-size: 16px;
    transition: background-color 0.3s ease;
}

.dd-button:hover {
    background-color: #0056b3;
}

.dd-button:disabled {
    background-color: #c0c0c0;
    cursor: not-allowed;
}
/* IMPS Form Specific Styles */
.imps-form {
    background-color: #f9f9f9;
    border: 1px solid #ccc;
    padding: 20px;
    border-radius: 8px;
    max-width: 400px;
    margin: 20px auto;
    display: none;
}

.imps-form h2 {
    font-size: 24px;
    color: #333;
    margin-bottom: 15px;
    text-align: center;
}

.imps-form table {
    width: 100%;
    margin-bottom: 15px;
}

.imps-form th {
    text-align: left;
    padding: 10px 0;
    font-weight: normal;
    color: #555;
}

.imps-form td {
    padding: 10px 0;
}

.imps-form input[type="text"],
.imps-form input[type="number"] {
    width: 100%;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-sizing: border-box;
}

.imps-form .form-info {
    font-size: 12px;
    color: #666;
    margin-bottom: 10px;
    text-align: center;
}

.imps-form #sendImpsButton {
    background-color:#0056b3 ;
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    width: 100%;
    font-size: 16px;
}

.imps-form #sendImpsButton:hover {
    background-color: #45a049;
}

.imps-form .error-message {
    color: red;
    font-size: 14px;
    margin-top: 10px;
    text-align: center;
}

/* Additional media queries for responsiveness */
@media (max-width: 768px) {
    .imps-form {
        max-width: 100%;
        padding: 15px;
    }
}


.bill-payments {
    background-color: #ffffff;
    padding: 20px;
    margin: 20px;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    display: none; /* Initially hidden */
    max-width: 800px;
    margin: auto; /* Center the panel */
}

.bill-payments h2 {
    font-size: 24px;
    margin-bottom: 20px;
    text-align: center; /* Center align title */
}

.bill-payment-options {
    display: flex;
    flex-wrap: wrap;
    gap: 15px; /* Adds space between buttons */
    justify-content: center; /* Center the buttons */
}

.bill-payment-options button {
    flex: 1 1 180px;
    max-width: 300px;
    padding: 15px;
    background-color: #007bff;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    text-align: center;
    transition: background-color 0.3s ease;
    font-size: 16px;
}

.bill-payment-options button:hover {
    background-color: #0056b3;
}
.passbook-table {
    background-color: #ffffff;
    padding: 20px;
    margin: 20px;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    max-width: 800px;
    margin: auto; /* Center the panel */
}

.passbook-table h2 {
    font-size: 24px;
    margin-bottom: 20px;
    text-align: center; /* Center align title */
}

.passbook-table table {
    width: 100%;
    border-collapse: collapse;
}

.passbook-table th, .passbook-table td {
    border: 1px solid #ddd;
    padding: 10px;
    text-align: left;
}

.passbook-table th {
    background-color: #f0f0f0;
}

.date-range-selection {
    margin-top: 20px;
    display: flex;
    flex-wrap: wrap;
    gap: 15px; /* Adds space between inputs and button */
    justify-content: center; /* Center the inputs and button */
}

.date-range-selection label {
    font-size: 16px;
    margin-right: 10px;
}

.date-range-selection input[type="date"] {
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 5px;
}

#generateStatementButton {
    background-color: #007bff;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    padding: 10px 20px;
    font-size: 16px;
    transition: background-color 0.3s ease;
}

#generateStatementButton:hover {
    background-color: #0056b3;
}
.account-closure-form {
    background-color: #ffffff;
    padding: 20px;
    margin: 20px;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    max-width: 800px;
    margin: auto; /* Center the panel */
}

.account-closure-form h2 {
    font-size: 24px;
    margin-bottom: 20px;
    text-align: center; /* Center align title */
}

.account-closure-form form {
    display: flex;
    flex-direction: column;
    align-items: center;
}

.account-closure-form label {
    font-size: 16px;
    margin-bottom: 10px;
}

.account-closure-form textarea {
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 5px;
    width: 100%;
    height: 100px;
}

.account-closure-form button {
    background-color: #007bff;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    padding: 10px 20px;
    font-size: 16px;
    transition: background-color 0.3s ease;
}

.account-closure-form button:hover {
    background-color: #0056b3;
}

.confirmation-dialog {
    display: none; /* Hide by default */
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: #ffffff;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    width: 300px;
}

.transfer-details-form {
    display: none; /* Hide by default */
    background-color: #ffffff;
    padding: 20px;
    margin: 20px;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    max-width: 800px;
    margin: auto; /* Center the panel */
}
/* Container for FD form and Previous FDs */
.fd-container {
    display: flex;
    justify-content: space-between;
    gap: 20px; /* Space between the form and previous FDs */
    max-width: 1200px; /* Limit the total width */
    margin: 40px auto;
}

.fd-form, #previousFDsContainer {
    flex: 1; /* Take up equal space */
    background-color: #f7f7f7;
    padding: 30px;
    border: 1px solid #ddd;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
}

/* FD Form Styling */
.fd-form h2 {
    font-size: 20px;
    margin-bottom: 20px;
    text-align: center; /* Center align title */
    color: #333;
}

.fd-form label {
    display: block;
    margin-bottom: 10px;
    font-size: 16px;
    color: #666;
}

.fd-form input[type="text"], .fd-form input[type="number"] {
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 5px;
    width: 100%;
    margin-bottom: 20px;
}

.fd-form input[type="text"]:focus, 
.fd-form input[type="number"]:focus,
.fd-form select:focus {
    border-color: #0056b3;
    outline: none;
}

.fd-form select {
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 5px;
    width: 100%;
    margin-bottom: 20px;
}

.fd-form button {
    background-color: #0056b3;
    color: #fff;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    padding: 10px 20px;
    font-size: 16px;
    transition: background-color 0.3s ease;
}

.fd-form button:hover {
    background-color: #004494;
}

.fd-form .readonly-field {
    background-color: #f0f0f0;
    border: 1px solid #ccc;
    padding: 10px;
    border-radius: 5px;
    width: 100%;
    margin-bottom: 20px;
}

/* Previous FDs Container */
#previousFDsContainer {
    padding: 20px;
    background-color: #f9f9f9;
    border: 1px solid #ddd;
    border-radius: 10px;
}

#previousFDsContainer h2 {
    font-size: 24px;
    margin-bottom: 15px;
    color: #333;
    text-align: center; /* Center align title */
}

#previousFDsTable {
    width: 100%;
    border-collapse: collapse;
}

#previousFDsTable th, #previousFDsTable td {
    padding: 12px;
    text-align: left;
    border-bottom: 1px solid #ddd;
}

#previousFDsTable th {
    background-color: #f2f2f2;
    font-weight: bold;
    color: #555;
}

#previousFDsTable td {
    color: #333;
}

#previousFDsTable tr:hover {
    background-color: #f1f1f1;
}

/* Responsive Design: Adjust the layout for smaller screens */
@media (max-width: 768px) {
    .fd-container {
        flex-direction: column;
    }
}

button {
    padding: 10px 15px;
    background-color: #4CAF50;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}

button:hover {
    background-color: #45a049;
}

.readonly-field {
    background-color: #f2f2f2;
    border: 1px solid #ccc;
    padding: 8px;
    width: 100%;
}

/* Container for the loan management form and the previous loans table */
.loan-mgmt-container {
    display: flex;
    justify-content: space-between;
    align-items: flex-start; /* Ensures the top of both sections align */
    gap: 20px;
    margin-top: 20px;
}

/* Styling for the loan application form */
.loan-mgmt-form {
    width: 48%;
    padding: 20px;
    border: 1px solid #ddd;
    background-color: #f9f9f9;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

/* Styling for the form fields */
.loan-mgmt-form label {
    display: block;
    margin-bottom: 8px;
    font-weight: bold;
}

.loan-mgmt-form input,
.loan-mgmt-form select,
.loan-mgmt-form button {
    width: 100%;
    padding: 10px;
    margin-bottom: 15px;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-sizing: border-box;
    font-size: 16px;
}

.loan-mgmt-form button {
    background-color: #004494;
    color: white;
    cursor: pointer;
    font-size: 16px;
}

.loan-mgmt-form button:disabled {
    background-color: #ccc;
    cursor: not-allowed;
}

.loan-mgmt-form button:hover:enabled {
    background-color: #004494;
}

/* Loading and error/success messages */
#loading {
    font-size: 16px;
    color: #555;
}

#error-message {
    color: red;
    margin-top: 10px;
}

#success-message {
    color: green;
    margin-top: 10px;
}

/* Styling for the previous loans table */
.loan-list {
    width: 48%;
    padding: 20px;
    border: 1px solid #ddd;
    background-color: #fff;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

.loan-list table {
    width: 100%;
    border-collapse: collapse;
}

.loan-list th, 
.loan-list td {
    padding: 12px;
    border: 1px solid #ddd;
    text-align: left;
}

.loan-list th {
    background-color: #f2f2f2;
    font-weight: bold;
}

.loan-list td {
    background-color: #f9f9f9;
}

.loan-list tr:nth-child(even) {
    background-color: #f2f2f2;
}

.modal {
            display: none; 
            position: fixed; 
            z-index: 1; 
            left: 0;
            top: 0;
            width: 100%; 
            height: 100%; 
            overflow: auto; 
            background-color: rgb(0,0,0); 
            background-color: rgba(0,0,0,0.4); 
        }

        .modal-content {
            background-color: #fefefe;
            margin: 15% auto; 
            padding: 20px;
            border: 1px solid #888;
            width: 80%; 
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }
        #fetchTransactions {
    background:#0056b3 ; ;
    color: white;              
    padding: 10px 20px;         
    border: none;               
    border-radius: 5px;         
    cursor: pointer;           
    font-size: 16px;            
    transition: background-color 0.3s ease; 
}

#fetchTransactions:hover {
    background-color: #45a049;  /* Darker green on hover */
}
.date-range-selection {
    margin: 20px 0;
    display: flex;
    align-items: center;
}

.date-range-selection label {
    margin-right: 10px;
}

.date-range-selection input {
    margin-right: 20px;
    padding: 5px;
}

#generateStatementButton {
    background-color: #4CAF50; /* Green */
    border: none;
    color: white;
    padding: 10px 20px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 16px;
    margin: 10px 2px;
    cursor: pointer;
    border-radius: 5px;
    transition: background-color 0.3s;
}

#generateStatementButton:hover {
    background-color: #45a049;
}
/* ELECTRICITY */
.elec-form {
    background-color: #f9f9f9;
    border: 1px solid #ccc;
    padding: 20px;
    border-radius: 8px;
    max-width: 400px;
    margin: 20px auto;
    display: none;
}

.elec-form select {
    width: 100%;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-sizing: border-box;
}

.elec-form h2 {
    font-size: 24px;
    color: #333;
    margin-bottom: 15px;
    text-align: center;
}

.elec-form table {
    width: 100%;
    margin-bottom: 15px;
}

.elec-form th {
    text-align: left;
    padding: 10px 0;
    font-weight: normal;
    color: #555;
}

.elec-form td {
    padding: 10px 0;
}

.elec-form input[type="text"],
.elec-form input[type="number"] {
    width: 100%;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-sizing: border-box;
}

.elec-form .form-info {
    font-size: 12px;
    color: #666;
    margin-bottom: 10px;
    text-align: center;
}

.elec-form #proceedButton {
    background-color: #0056b3;
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    width: 100%;
    font-size: 16px;
}

.elec-form #proceedButton:hover {
    background-color: #45a049;
}

.elec-form .error-message {
    color: red;
    font-size: 14px;
    margin-top: 10px;
    text-align: center;
}

/* Additional media queries for responsiveness */
@media (max-width: 768px) {
    .elec-form {
        max-width: 100%;
        padding: 15px;
    }
}

/* Water form */
.water-form {
    background-color: #f9f9f9;
    border: 1px solid #ccc;
    padding: 20px;
    border-radius: 8px;
    max-width: 400px;
    margin: 20px auto;
    display: none;
}

.water-form select,
.water-form input[type="text"],
.water-form input[type="number"] {
    width: 100%;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-sizing: border-box;
}

.water-form h2 {
    font-size: 24px;
    color: #333;
    margin-bottom: 15px;
    text-align: center;
}

.water-form table {
    width: 100%;
    margin-bottom: 15px;
}

.water-form th {
    text-align: left;
    padding: 10px 0;
    font-weight: normal;
    color: #555;
}

.water-form td {
    padding: 10px 0;
}

.water-form #proceedButtonWater {
    background-color: #0056b3;
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    width: 100%;
    font-size: 16px;
}

.water-form #proceedButtonWater:hover {
    background-color: #45a049;
}

.water-form .error-message {
    color: red;
    font-size: 14px;
    margin-top: 10px;
    text-align: center;
}

@media (max-width: 768px) {
    .water-form {
        max-width: 100%;
        padding: 15px;
    }
}


/* LPG form */
.lpg-form {
    background-color: #f9f9f9;
    border: 1px solid #ccc;
    padding: 20px;
    border-radius: 8px;
    max-width: 400px;
    margin: 20px auto;
    display: none;
}

.lpg-form select,
.lpg-form input[type="text"],
.lpg-form input[type="number"] {
    width: 100%;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-sizing: border-box;
}

.lpg-form h2 {
    font-size: 24px;
    color: #333;
    margin-bottom: 15px;
    text-align: center;
}

.lpg-form table {
    width: 100%;
    margin-bottom: 15px;
}

.lpg-form th {
    text-align: left;
    padding: 10px 0;
    font-weight: normal;
    color: #555;
}

.lpg-form td {
    padding: 10px 0;
}

.lpg-form #proceedButtonLpg {
    background-color: #0056b3;
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    width: 100%;
    font-size: 16px;
}

.lpg-form #proceedButtonLpg:hover {
    background-color: #45a049;
}

.lpg-form .error-message {
    color: red;
    font-size: 14px;
    margin-top: 10px;
    text-align: center;
}

@media (max-width: 768px) {
    .lpg-form {
        max-width: 100%;
        padding: 15px;
    }
}

/* Password Popup Styles */
.password-popup {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    display: flex;
    justify-content: center;
    align-items: center;
}

.popup-content {
    background-color: white;
    padding: 20px;
    border-radius: 8px;
    max-width: 300px;
    width: 100%;
    text-align: center;
}

.popup-content input[type="password"] {
    width: 100%;
    padding: 10px;
    margin-bottom: 15px;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-sizing: border-box;
}

.popup-content button {
    background-color: #0056b3;
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    width: 100%;
    font-size: 16px;
    margin-bottom: 10px;
}

.popup-content button:hover {
    background-color: #45a049;
}



/* Mobile Recharge Form */
.recharge-form {
    background-color: #f9f9f9;
    border: 1px solid #ccc;
    padding: 20px;
    border-radius: 8px;
    max-width: 400px;
    margin: 20px auto;
    display: none;
}

.recharge-form select,
.recharge-form input[type="text"],
.recharge-form input[type="number"] {
    width: 100%;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-sizing: border-box;
}

.recharge-form h2 {
    font-size: 24px;
    color: #333;
    margin-bottom: 15px;
    text-align: center;
}

.recharge-form table {
    width: 100%;
    margin-bottom: 15px;
}

.recharge-form th {
    text-align: left;
    padding: 10px 0;
    font-weight: normal;
    color: #555;
}

.recharge-form td {
    padding: 10px 0;
}

.recharge-form #proceedButtonRecharge {
    background-color: #0056b3;
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    width: 100%;
    font-size: 16px;
}

.recharge-form #proceedButtonRecharge:hover {
    background-color: #45a049;
}

.recharge-form .error-message {
    color: red;
    font-size: 14px;
    margin-top: 10px;
    text-align: center;
}

@media (max-width: 768px) {
    .recharge-form {
        max-width: 100%;
        padding: 15px;
    }
}
 /* Style for the Recent Transactions heading */
 .transaction-heading {
            text-align: center; /* Center align the heading */
            margin: 20px 0;    /* Add some margin above and below */
            font-size: 24px;    /* Adjust font size */
            color: #333;        /* Change text color */
        }
/* Transaction Table */
#transactionTable {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
}

/* Table Header */
#transactionTable th {
    background-color: #007BFF; /* Bootstrap primary color */
    color: white;
    padding: 12px;
    text-align: left;
}

/* Table Cells */
#transactionTable td {
    padding: 12px;
    border: 1px solid #ddd;
}

/* Row Hover Effect */
#transactionTable tbody tr:hover {
    background-color: #f1f1f1;
}

/* Display the table only when needed */
#transactionTable {
    display: none; /* Initially hidden; show when there are transactions */
}
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
    <header class="header">
        <img src="logo.png" alt="Ideal Bank Logo">
        <div class="date-time">
            <p>
                <img src="calendar.png" alt="Calendar Icon">
                <span id="date"></span>
            </p>
            <p>
                <img src="clock.png" alt="Clock Icon">
                <span id="time"></span>
            </p>
        </div>
        <div class="profile-actions">
            <button onclick="showProfile()">
                <img src="profile.png" alt="Profile Icon"> Profile
            </button>
            <button onclick="logout()">
                <img src="logout.png" alt="Logout Icon"> Logout
            </button>
        </div>
    </header>

    <div class="marquee">
        <span id="marqueeText">Welcome to Ideal Bank - Your Trusted Partner in Banking!</span>
    </div>
    <div class="main-content">
        <div class="button-row">
            <button onclick="openFundTransfers()">Fund Transfers</button>
            <button onclick="openBillPayments()">Bill Payments & Recharges</button>
            <button onclick="openPassbook()">Passbook</button>
            <button onclick="openFD()">Fixed Deposits</button>
            <button onclick="openLoanManagement()">Loan Management</button>
            <button onclick="openAccountClosure()">Account Closure</button>

        </div>
        


        <!-- Bill Payments Section -->

        <div class="bill-payments" id="billPaymentsSection" style="display: none;">
            <h2>Bill Payments & Recharges</h2>
            <div class="bill-payment-options">
                <button id="electricityBillButton" onclick="openElectric()">Electricity Bill</button>
                <button id="waterBillButton" onclick="openWater()">Water Bill</button>
                <button id="lpgBillButton" onclick="openLpg()">LPG Bill</button>
                <button id="mobileRechargeButton" onclick="openRecharge()">Mobile Recharge</button>
            </div>
        </div>
        
        
        <!-- Electricity form  -->
        <div class="elec-form" id="electricityForm" style="display: none;"> 
            <h2>Electricity Billing Form</h2>
            <table>
                <tr>
                    <th>Company Name</th>
                    <td>
                        <select id="companyName">
                            <option value="" disabled selected>Select a Company</option>
                            <option value="msedcl">MSEDCL</option>
                            <option value="mspgcl">MSPGCL</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <th>Consumer Number</th>
                    <td><input type="text" id="consumerNumber" placeholder="Enter consumer number" required></td>
                </tr>
                <tr>
                    <th>Amount</th>
                    <td><input type="number" id="amount" placeholder="Enter amount" min="1" required></td>
                </tr>
            </table>
            
            <button id="proceedButton" onclick="proceedElectricBill()">Proceed</button>
        
            <!-- Error message for validation -->
            <div class="error-message" id="billingError" style="display: none;"></div>
        </div>
        
        <!-- Water Billing Form -->
        <div class="water-form" id="waterform" style="display: none;">
            <h2>Water Billing Form</h2>
            <table>
                <!-- <tr>
                    <th>Customer ID</th>
                    <td><input type="text" id="customerIdWater" placeholder="Customer ID" readonly></td>
                </tr> -->
                <tr>
                    <th>Company Name</th>
                    <td>
                        <select id="companyNameWater">
                            <option value="">Select Company</option>
                            <option value="mwrra">MWRRA</option>
                            <option value="mjp">MJP</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <th>Consumer Number</th>
                    <td><input type="text" id="consumerNumberWater" placeholder="Enter consumer number"></td>
                </tr>
                <tr>
                    <th>Amount</th>
                    <td><input type="number" id="amountWater" placeholder="Enter amount" min="1"></td>
                </tr>
            </table>
        
            <!-- Proceed button -->
            <button id="proceedButtonWater" onclick="proceedWater()">Proceed</button>
        
            <!-- Error message for validation -->
            <div class="error-message" id="billingErrorWater" style="display: none;"></div>
        </div>
        
        
        <!-- LPG Billing Form -->
        
        
        <div class="lpg-form" id="Lpgform" style="display: none;">
            <h2>LPG Billing Form</h2>
            <table>
                <tr>
                    <th>Company Name</th>
                    <td>
                        <select id="companyNameLpg">
                            <option value="">Select Company</option>
                            <option value="bharat">Bharat Gas</option>
                            <option value="hp">HP Gas</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <th>Consumer Number</th>
                    <td><input type="text" id="consumerNumberLpg" placeholder="Enter consumer number"></td>
                </tr>
                <tr>
                    <th>Amount</th>
                    <td><input type="number" id="amountLpg" placeholder="Enter amount" min="1"></td>
                </tr>
                <tr>
                    <th>Subsidy Eligibility</th>
                    <td><input type="checkbox" id="subsidyLpg"> Eligible for Subsidy</td>
                </tr>
            </table>
            <button id="proceedButtonLpg" onclick="proceedLpg()">Proceed</button>
        
            <!-- Error message for validation -->
            <div class="error-message" id="billingErrorLpg" style="display: none;"></div>
        </div>
        
        <!-- <div class="lpg-form" id="Lpgform" style="display: none;">
            <h2>LPG Billing Form</h2>
            <table>
                <tr>
                    <th>Customer ID</th>
                    <td><input type="text" id="customerIdLpg" placeholder="Customer ID" readonly></td>
                </tr>
                <tr>
                    <th>Company Name</th>
                    <td>
                        <select id="companyNameLpg">
                            <option value="">Select Company</option>
                            <option value="bharat">Bharat Gas</option>
                            <option value="hp">HP Gas</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <th>Consumer Number</th>
                    <td><input type="text" id="consumerNumberLpg" placeholder="Enter consumer number"></td>
                </tr>
                <tr>
                    <th>Amount</th>
                    <td><input type="number" id="amountLpg" placeholder="Enter amount" min="1"></td>
                </tr>
                <tr>
                    <th>Subsidy Eligibility</th>
                    <td><input type="checkbox" id="subsidyLpg"> Eligible for Subsidy</td>
                </tr>
            </table>
            <button id="proceedButtonLpg" onclick="proceedLpg()">Proceed</button>
        
             //Error message for validation 
            <div class="error-message" id="billingErrorLpg" style="display: none;"></div>
        </div>
        // Password Popup Div (initially hidden) 
        <div class="password-popup" id="passwordPopup" style="display: none;">
            <div class="popup-content">
                <h3>Enter Password</h3>
                <input type="password" id="passwordLpg" placeholder="Enter your password">
                <button id="submitPasswordLpg" onclick="submitLpgForm()">Submit</button>
                <button id="cancelPasswordLpg" onclick="closePasswordPopup()">Cancel</button>
                <div class="error-message" id="passwordErrorLpg" style="display: none;"></div>
            </div>
        </div> -->
        
        
        
        <!-- Mobile Recharge Form -->
        <div class="recharge-form" id="rechargeform" style="display: none;">
            <h2>Mobile Recharge Form</h2>
            <table>
                <tr>
                    <th>Mobile Number</th>
                    <td><input type="text" id="mobileNumber" placeholder="Enter mobile number"></td>
                </tr>
                <tr>
                    <th>Operator</th>
                    <td>
                        <select id="mobileOperator">
                            <option value="">Select Operator</option>
                            <option value="vi">Vi</option>
                            <option value="jio">Jio</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <th>Region</th>
                    <td>
                        <select id="region">
                            <option value="">Select Region</option>
                            <option value="maharashtra">Maharashtra</option>
                            <option value="delhi">Delhi</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <th>Amount</th>
                    <td><input type="number" id="amountRecharge" placeholder="Enter amount" min="10"></td>
                </tr>
            </table>
            <button id="proceedButtonRecharge" onclick="proceedRecharge()">Submit</button>
        
            <!-- Error message for validation -->
            <div class="error-message" id="rechargeError" style="display: none;"></div>
        </div>
<div class="loan-mgmt-container">
    <!-- Loan Management form container -->
    <div class="loan-mgmt-form" id="loanMgmtFormContainer" style="display: none;">
        <h2>Loan Management</h2>
        <form id="loanForm" onsubmit="return Loanapply(event)">
            <!-- Button to check previous loans -->
            <button type="button" onclick="Loanscheckprev()">Check Previous Applied Loans</button>
            
            <!-- Customer ID field (auto-filled) -->
            <label for="customerId">Customer ID:</label>
            <input type="text" id="customerId" name="customerId" placeholder="Enter your customer ID" readonly>

            <!-- Loan Type dropdown -->
            <label for="loanType">Loan Type:</label>
            <select id="loanType" name="loanType" required>
                <option value="">Select Loan Type</option>
                <option value="home">Home Loan</option>
                <option value="car">Car Loan</option>
                <option value="personal">Personal Loan</option>
                <option value="business">Business Loan</option>
            </select>

            <!-- Loan Amount field -->
            <label for="amount1">Amount (Rs.):</label>
            <input type="number" id="amount1" name="amount" placeholder="Enter loan amount" required>

            <!-- Loan Tenure field -->
            <label for="tenure">Tenure (Years):</label>
            <input type="number" id="tenure" name="tenure" placeholder="Enter loan tenure in years" required>

            <!-- Submit button -->
            <button type="submit" id="applyLoanButton">Submit</button>

            <!-- Loading Indicator -->
            <div id="loading" style="display: none;">Processing your loan application...</div>

            <!-- Messages -->
            <div id="error-message"></div>
            <div id="success-message"></div>
        </form>
    </div>

    <!-- Loan list container (for displaying previous loans) -->
    <div class="loan-list" id="loanListContainer" style="display: none;">
        <h2>Previous Loans</h2>
        <table id="loanTable">
            <thead>
                <tr>
                    <th>Loan ID</th>
                    <th>Loan Type</th>
                    <th>Amount (Rs.)</th>
                    <th>Tenure (Years)</th>
                    <th>Date</th>
                    <th>Reference ID</th> 
                </tr>
            </thead>
            <tbody>
                <!-- Loan records will be dynamically inserted here -->
            </tbody>
        </table>
    </div>
</div>


<!-- Account Closure Form -->
<div class="account-closure-form" id="accountClosureFormContainer">
    <h2>Request Account Closure</h2>
    <form id="accountClosureForm">
        <label for="customerid">Customer Id:</label><br>
        <input type="text" id="customerid" name="customerid" required minlength="6" maxlength="50" readonly placeholder="Fetching Customer ID..."><br><br>

        <label for="reason">Reason for Closure:</label><br>
        <textarea id="reason" name="reason" rows="4" cols="50" placeholder="Enter the reason for closure"></textarea><br><br>

        <input type="submit" value="Submit" onclick="accountClosure(event)">        
    </form>
</div>

<!-- FD Form and Previous FDs Container -->
<div class="fd-container">
    <!-- FD Form -->
    <div class="fd-form" id="fdFormContainer">
        <h2>Fixed Deposit</h2>
        <form id="fdForm">
            <label for="customerID">Customer Id:</label>
            <input type="text" id="customerID" name="customerID" readonly class="readonly-field">

            <label for="customerName">Customer Name:</label>
            <input type="text" id="customerName" name="customerName" readonly class="readonly-field">

            <label for="age">Age:</label>
            <input type="number" id="age" name="age" readonly>

            <label for="amountt">Amount:</label>
            <input type="number" id="amountt" name="amountt" required oninput="calculateROI()" />

            <label for="tenuree">Tenure:</label>
            <select id="tenuree" name="tenuree" required onchange="calculateROI()">
                <option value="">Select Tenure</option>
                <option value="14 days">14 days</option>
                <option value="3 months">3 months</option>
                <option value="6 months">6 months</option>
                <option value="1 year">1 year</option>
                <option value="2 years">2 years</option>
                <option value="5 years">5 years</option>
                <option value="10 years">10 years</option>
            </select>

            <label for="roi">Rate of Interest (ROI):</label>
            <input type="number" id="roi" name="roi" required readonly />

            <label for="maturityDate">Maturity Date:</label>
            <input type="date" id="maturityDate" name="maturityDate" readonly />

            <label for="totalAmount">Total Amount after Tenure:</label>
            <input type="number" id="totalAmount" name="totalAmount" required readonly />

            <button type="button" id="submitFD" onclick="FDsubmit()">Submit</button>
            <br>
            <button type="button" id="previousFDs" onclick="showPreviousFDs()">Previous FDs</button>
        </form>
    </div>

    <!-- Previous FDs -->
    <div id="previousFDsContainer">
        <h2>Previous Fixed Deposits</h2>
        <table id="previousFDsTable">
            <thead>
                <tr>
                    <th>Customer Name</th>
                    <th>Amount</th>
                    <th>Age</th>
                    <th>Tenure</th>
                    <th>ROI</th>
                    <th>Total Amount</th>
                    <th>Created At</th>
                    <th>Maturity Date</th> <!-- Added column for Maturity Date -->
                </tr>
                </tr>
            </thead>
            <tbody>
                <!-- Previous FDs will be inserted here -->
            </tbody>
        </table>
    </div>
</div>

    <!-- Passbook Table -->
<div class="passbook-table" id="passbookTableContainer">
    <h2>Passbook</h2>
    <div>
        <label for="customerId">Customer ID:</label>
        <input type="text" id="customerIdPass" placeholder="Enter Customer ID" disabled>
        <button id="fetchTransactions" onclick="fetchTransactions()">Fetch Transactions</button>
    </div>

    <table id="passbookTable">
        <thead>
            <tr>
                <th>Date</th>
                <th>Particulars</th>
                <th>Amount</th>
                <th>Balance After</th>
            </tr>
        </thead>
        <tbody id="passbookTableBody">
            <!-- Table data will be displayed here -->
        </tbody>
    </table>

    <!-- Date Range Selection -->
    <div class="date-range-selection">
        <label for="startDate">Start Date:</label>
        <input type="date" id="startDate" />
        <label for="endDate">End Date:</label>
        <input type="date" id="endDate" />
        <button id="generateStatementButton" onclick="generateStatement()">Generate Statement</button>
    </div>
</div>




<!-- Fund Transfer Panel -->
  <div class="fund-transfer" id="fundTransferPanel">
    <h2>Fund Transfer Options</h2>
    <div class="fund-transfer-options">
        <button id="impsButton" onclick="openImps()">IMPS(MOBILE)</button>
        <button id="rtgsButton" onclick="openRTGS()">RTGS (More than 2 Lakhs)</button>
        <button id="neftButton" onclick="openNEFT()">NEFT</button>
        <button id="ddButton" onclick="openDD()">Demand Draft (DD)</button>
       
    </div>
   <!-- Transfer Form (Initially hidden) -->
  


  <!-- IMPS Transfer Form -->
  <div class="imps-form" id="impsForm">
      <h2>IMPS Transfer Form</h2>
      <table>
          <tr>
              <th>Mobile Number</th>
              <td><input type="text" id="mobileNumberImps" placeholder="Enter mobile number for IMPS"></td>
          </tr>
          <tr>
              <th>Amount</th>
              <td><input type="number" id="amountImps" placeholder="Enter amount"></td>
          </tr>
      </table>
      <p class="form-info">For IMPS, the amount must be greater than 0.</p>

      <button id="sendImpsButton" onclick="sendImps()">Send IMPS</button>

      <!-- Error message for IMPS validation -->
      <div class="error-message" id="impsError" style="display: none;">Amount must be greater than 0 for IMPS transfers.</div>
  </div>

<!-- RTGS Transfer Form -->
<div class="transfer-form rtgs-form" id="rtgsForm">
    <label for="accNoRTGS">Account Number</label>
    <input type="text" id="accNoRTGS" placeholder="Enter account number for RTGS">

    <label for="customerNameRTGS">Customer Name</label>
    <input type="text" id="customerNameRTGS" placeholder="Enter customer name">

    <label for="accTypeRTGS">Account Type</label>
    <select id="accTypeRTGS">
        <option value="savings">Savings</option>
        <option value="current">Current</option>
    </select>

    <label for="particularsRTGS">Particulars</label>
    <input type="text" id="particularsRTGS" placeholder="Enter particulars">

    <label for="amountRTGS">Amount (Minimum 2,00,000)</label>
    <input type="number" id="amountRTGS" placeholder="Enter amount">

    <p class="form-info">For RTGS, the amount must be greater than 2,00,000.</p>

    <button id="sendRTGSButton" onclick="sendRTGS()">Send RTGS</button>

    <!-- Error message for RTGS validation -->
    <div class="error-message" id="rtgsError" style="display: none;">Amount must be greater than 2,00,000 for RTGS transfers.</div>
</div>


<!-- NEFT Transfer Form -->
<div class="transfer-form neft-form" id="neftForm">
    <label for="destAccNoNEFT">Account Number</label>
    <input type="text" id="destAccNoNEFT" placeholder="Enter account number for NEFT">

    <label for="customerNameNEFT">Customer Name</label>
    <input type="text" id="customerNameNEFT" placeholder="Enter customer name">

    <label for="accTypeNEFT">Account Type</label>
    <select id="accTypeNEFT">
        <option value="savings">Savings</option>
        <option value="current">Current</option>
    </select>

    <label for="particularsNEFT">Particulars</label>
    <input type="text" id="particularsNEFT" placeholder="Enter particulars">

    <label for="amountNEFT">Amount</label>
    <input type="number" id="amountNEFT" placeholder="Enter amount">

    <p class="form-info">NEFT allows any amount to be transferred less than 2 Lakhs.</p>

    <button id="sendNEFTButton" onclick="sendNEFT()">Send NEFT</button>

    <!-- Error message for NEFT validation -->
    <div class="error-message" id="neftError" style="display: none;">Amount must be less than 2,00,000 for NEFT transfers.</div>
</div>
<!-- Demand Draft Form (Initially hidden) -->
<div class="transfer-form dd-form" id="ddForm">
    <h2>Demand Draft Form</h2>
    <label for="payeeName">Payee Name</label>
    <input type="text" id="payeeName" placeholder="Enter payee name">

    <label for="ddAmount">Amount</label>
    <input type="number" id="ddAmount" placeholder="Enter amount">
    
    <p class="form-info">Charges as per applicable:
        <br>Amounts between Rs 10,000 and Rs 20,000: Rs 100
        <br>Amounts between Rs 20,000 and Rs 50,000: Rs 200
        <br> Amounts between Rs 50,000 and Rs 1,00,000: Rs 300
        <br> Amounts between Rs 1,00,000 and Rs 2,00,000: Rs 500
        <br> Amounts above Rs 2,00,000: Rs 700
    </p>
    <P><b>dd is not for less than Rs10,000</b></P>

    <p><b>Note:After transaction successful message visit branch ,give your account number/or show downloaded dd pdf  and collect reciept without queue </b></p>

    <button id="processDDButton" class="dd-button" onclick="processDD()">Proceed</button>
     <!-- Modal -->
<div id="ddModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal()">&times;</span>
        <h2>Success!</h2>
        <p>Your Demand Draft has been successfully processed!</p>
        <p><strong>Reference Number:</strong> <span id="modalReferenceNumber"></span></p>
        <p>Visit the nearest branch with this reference number to collect your Demand Draft without standing in a queue.</p>
    </div>
</div>

</div>
</div>

      

    <div class="profilecontainer">
        <div class="profile-info" id="profileInfo">
            <h1>Profile Information</h1>
            <div class="profile-tables">
                <div class="table-container">
                    <table>
                        <tr>
                            <th>Name</th>
                            <td><input type="text" id="name" readonly></td>
                        </tr>
                        <tr>
                            <th>Date of Birth</th>
                            <td><input type="text" id="dob" readonly></td>
                        </tr>
                        <tr>
                            <th>Gender</th>
                            <td><input type="text" id="gender" readonly></td>
                        </tr>
                        <tr>
                            <th>Aadhar</th>
                            <td><input type="text" id="aadhar" readonly></td>
                        </tr>
                        <tr>
                            <th>PAN</th>
                            <td><input type="text" id="pan" readonly></td>
                        </tr>
                        <tr>
                            <th>Joint Name</th>
                            <td><input type="text" id="jointName" readonly></td>
                        </tr>
                        <tr>
                            <th>Joint Date of Birth</th>
                            <td><input type="text" id="jointDob" readonly></td>
                        </tr>
                        <tr>
                            <th>Joint Gender</th>
                            <td><input type="text" id="jointGender" readonly></td>
                        </tr>
                        <tr>
                            <th>Joint Aadhar</th>
                            <td><input type="text" id="jointAadhar" readonly></td>
                        </tr>
                        <tr>
                            <th>Joint PAN</th>
                            <td><input type="text" id="jointPan" readonly></td>
                        </tr>
                    </table>
                </div>
                <div class="table-container">
                    <table>
                        <tr>
                            <th>Account Type</th>
                            <td><input type="text" id="accountType" readonly></td>
                        </tr>
                        <tr>
                            <th>Address</th>
                            <td><input type="text" id="address" readonly></td>
                        </tr>
                        <tr>
                            <th>Email</th>
                            <td><input type="text" id="email" readonly></td>
                        </tr>
                  
                        <tr>
                            <th>Mobile Number</th>
                            <td><input type="text" id="mobileNumber1" readonly></td>
                        </tr>
                        <tr>
                            <th>Operation Mode</th>
                            <td><input type="text" id="operationMode" readonly></td>
                        </tr>
                        <tr>
                            <th>Account Type Detail</th>
                            <td><input type="text" id="accountTypeDetail" readonly></td>
                        </tr>
                        <tr>
                            <th>Account Number</th>
                            <td><input type="text" id="accountNumber" readonly></td>
                        </tr>
                        <tr>
                            <th>Customer ID</th>
                        <td><input type="text" id="customerIdProfile" readonly></td> <!-- Updated ID to prevent conflict -->
                        </tr>
                        <tr>
                            <th>Account Opening Date</th>
                            <td><input type="text" id="accOpeningDate" readonly></td>
                        </tr>
                    </table>
                </div>
            </div>
            <div class="btn-container">
                <button onclick="hideProfile()">Back</button>
            </div>
        </div>
    </div>
    <div class="transaction-heading">Recent Five Transactions</div>
    <table id="transactionTable" style="display:none;">
        <thead>
          
            <tr>
                
                <th>Transaction ID</th>
                <th>Amount</th>
                <th>Date</th>
                <th>Particulars</th>
                <th>Balance After</th>
            </tr>
        </thead>
        <tbody>
            <!-- Transaction rows will be appended here -->
        </tbody>
    </table>
    <footer class="footer">
        &copy; 2024 Ideal Bank. All Rights Reserved.
    </footer>

    <script>
        function logout() {
            localStorage.removeItem('username');
            window.location.href = 'index.html';
        }

        function showProfile() {
            document.querySelector('.transaction-heading').style.display = 'none';
            document.getElementById('profileInfo').style.display = 'block';
    document.getElementById('fundTransferPanel').style.display = 'none';
    document.getElementById('rtgsForm').style.display = 'none';
    document.getElementById('neftForm').style.display = 'none';
    document.getElementById('ddForm').style.display = 'none';
            document.getElementById('profileInfo').style.display = 'block';
            document.getElementById('billPaymentsSection').style.display = 'none';
            const passbookTableContainer = document.getElementById('passbookTableContainer');
    passbookTableContainer.style.display = 'none';
    document.getElementById('fdFormContainer').style.display = 'none';
    const accountClosureFormContainer = document.getElementById('accountClosureFormContainer');
    accountClosureFormContainer.style.display = 'none';
    loanMgmtFormContainer.style.display = "none";
  
 document.getElementById('previousFDsContainer').style.display = 'none';
 // Other sections hidden as required
 document.getElementById('loanListContainer').style.display = 'none'; // Hide loan list initially
 const rechargeForm = document.getElementById('rechargeform');
    rechargeForm.style.display = 'none';

    // Optionally hide other sections/forms if necessary
    document.getElementById('electricityForm').style.display = 'none'; 
    document.getElementById('waterform').style.display = 'none';
    document.getElementById('Lpgform').style.display = 'none';
    transactionTable.style.display = 'none';
    




            const username = localStorage.getItem('username');
            if (username) {
                fetch(`http://localhost:3001/dashboard?username=${username}`)
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            const user = data.user;
                            document.getElementById('name').value = user.name;
                            document.getElementById('dob').value = formatDate(user.dob);  
                            document.getElementById('gender').value = user.gender;
                            document.getElementById('aadhar').value = user.aadhar;
                            document.getElementById('pan').value = user.pan;
                            document.getElementById('jointName').value = user.joint_name;
                            document.getElementById('jointDob').value = formatDate(user.joint_dob); 
                            document.getElementById('jointGender').value = user.joint_gender;
                            document.getElementById('jointAadhar').value = user.joint_aadhar;
                            document.getElementById('jointPan').value = user.joint_pan;
                            document.getElementById('accountType').value = user.account_type;
                            document.getElementById('address').value = user.address;
                            document.getElementById('email').value = user.email;
                            document.getElementById('operationMode').value = user.operation_mode;
                            document.getElementById('accountTypeDetail').value = user.account_type_detail;
                            document.getElementById('accountNumber').value = user.account_number;
                            document.getElementById('customerIdProfile').value = user.customer_id;
                            document.getElementById('accOpeningDate').value = formatDate(user.acc_opening_date);
                         
                            document.getElementById('mobileNumber1').value = user.mobile_number;
                        } else {
                            console.log('Error fetching profile data:', data.error);
                        }
                    })
                    .catch(error => console.error('Error:', error));
            }
        }
        function formatDate(dateString) {
    if (dateString === null || dateString === 'NULL') {
        return 'Not Available';
    } else {
        const date = new Date(dateString);
        const year = date.getFullYear();
        const month = ('0' + (date.getMonth() + 1)).slice(-2);  // Ensure 2 digits for month
        const day = ('0' + date.getDate()).slice(-2);  // Ensure 2 digits for day
        return `${year}-${month}-${day}`;  // Returning formatted date as YYYY-MM-DD
    }
}
function hideProfile() {
    document.getElementById('profileInfo').style.display = 'none'; // Hide profile section
    document.getElementById('fundTransferPanel').style.display = 'none'; // Show fund transfer panel
    transactionTable.style.display = 'none';
    // Show other sections as needed
}
        function displayDateTime() {
            const now = new Date();
            const date = now.toLocaleDateString();
            const time = now.toLocaleTimeString();
            document.getElementById('date').textContent = `Date: ${date}`;
            document.getElementById('time').textContent = `Time: ${time}`;
        }

        setInterval(displayDateTime, 1000);

        let transferType = ''; // To keep track of the selected transfer type

function openFundTransfers() {
    document.getElementById('fundTransferPanel').style.display = 'block'; // Show fund transfer panel
    document.getElementById('rtgsForm').style.display = 'none'; // Hide both forms initially
    document.getElementById('neftForm').style.display = 'none';
    document.getElementById('profileInfo').style.display = 'none'; // Hide Profile section
    document.getElementById('billPaymentsSection').style.display = 'none';
    const passbookTableContainer = document.getElementById('passbookTableContainer');
    passbookTableContainer.style.display = 'none';
    document.getElementById('fdFormContainer').style.display = 'none';
    const accountClosureFormContainer = document.getElementById('accountClosureFormContainer');
    accountClosureFormContainer.style.display = 'none';
    document.getElementById('impsForm').style.display = 'none';
    document.getElementById('previousFDsContainer').style.display = 'none';
    // Other sections hidden as required
    loanMgmtFormContainer.style.display = "none";

    document.getElementById('loanListContainer').style.display = 'none'; // Hide loan list initially
    const rechargeForm = document.getElementById('rechargeform');
    rechargeForm.style.display = 'none';

    // Optionally hide other sections/forms if necessary
    document.getElementById('electricityForm').style.display = 'none'; 
    document.getElementById('waterform').style.display = 'none';
    document.getElementById('Lpgform').style.display = 'none';
    transactionTable.style.display = 'none';
    document.querySelector('.transaction-heading').style.display = 'none';

}

function hideOtherForms() {
    document.getElementById('rtgsForm').style.display = 'none';
    document.getElementById('neftForm').style.display = 'none';
    document.getElementById('ddForm').style.display = 'none';
    document.getElementById('impsForm').style.display = 'none';
    document.getElementById('profileInfo').style.display = 'none';
}

// Function to go back to the main options
function backToMain() {
    document.getElementById('upiIDGeneration').style.display = 'none';
    document.getElementById('upiSendMoneySection').style.display = 'none';
    document.getElementById('upiMainButtons').style.display = 'block';
    document.getElementById('generateUPIButton').disabled = false; // Re-enable the button
    document.querySelector('.transaction-heading').style.display = 'none';
}

function openRTGS() {
    alert('RTGS is only available for amounts over 2,00,000.'); // Pop-up alert for RTGS
    transferType = 'RTGS';
    document.getElementById('rtgsForm').style.display = 'block'; // Show RTGS form
    document.getElementById('neftForm').style.display = 'none'; // Hide NEFT form
    document.getElementById('ddForm').style.display = 'none'; // Hide DD form
    document.getElementById('profileInfo').style.display = 'none'; // Hide Profile section
    document.getElementById('impsForm').style.display = 'none'; // Hide UPI form
    document.getElementById('previousFDsContainer').style.display = 'none';
    const rechargeForm = document.getElementById('rechargeform');
    rechargeForm.style.display = 'none';

    // Optionally hide other sections/forms if necessary
    document.getElementById('electricityForm').style.display = 'none'; 
    document.getElementById('waterform').style.display = 'none';
    document.getElementById('Lpgform').style.display = 'none';
    transactionTable.style.display = 'none';
    document.querySelector('.transaction-heading').style.display = 'none';
   

    hideUPIButtons();

    resetForm('rtgs'); // Reset RTGS form
}



function openNEFT() {
    transferType = 'NEFT';
    document.getElementById('rtgsForm').style.display = 'none'; // Hide RTGS form
    document.getElementById('neftForm').style.display = 'block'; // Show NEFT form
    document.getElementById('ddForm').style.display = 'none'; // Hide DD form
    document.getElementById('profileInfo').style.display = 'none'; // Hide Profile section
    document.getElementById('impsForm').style.display = 'none'; // Hide UPI form
    document.getElementById('previousFDsContainer').style.display = 'none';
    // Other sections hidden as required
    document.getElementById('loanListContainer').style.display = 'none'; // Hide loan list initially
    const rechargeForm = document.getElementById('rechargeform');
    rechargeForm.style.display = 'none';

    // Optionally hide other sections/forms if necessary
    document.getElementById('electricityForm').style.display = 'none'; 
    document.getElementById('waterform').style.display = 'none';
    document.getElementById('Lpgform').style.display = 'none';
    transactionTable.style.display = 'none';
    document.querySelector('.transaction-heading').style.display = 'none';
    
    hideUPIButtons();

    resetForm('neft'); // Reset NEFT form
}

// Function to send RTGS request
function sendRTGS() {
    const username = localStorage.getItem('username');
    const button = document.getElementById('sendRTGSButton');
    button.disabled = true; // Disable button

    if (username) {
        fetch(`http://localhost:3001/dashboard?username=${username}`)
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    const user = data.user;
                    const scaccountnumber = user.account_number;
                    const destinationAccountNumber = document.getElementById("accNoRTGS").value;
                    const amount = parseFloat(document.getElementById("amountRTGS").value);

                    // Validate amount for RTGS
                    if (amount < 200000) {
                        document.getElementById("rtgsError").style.display = "block";
                        return;
                    }
                    document.getElementById("rtgsError").style.display = "none";

                    // Send RTGS request to the server
                    fetch('http://localhost:3001/transfer/rtgs', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ scaccountnumber, destinationAccountNumber, amount })
                    })
                    .then(response => response.json())
                    .then(data => alert(data.message))
                    .catch(error => console.error('Error:', error));
                } else {
                    console.log('Error fetching profile data:', data.error);
                }
            });
    } else {
        console.log('No username found in localStorage.');
        button.disabled = false; // Enable button
    }
}

// Function to send NEFT request
function sendNEFT() {
    const username = localStorage.getItem('username');
    const button = document.getElementById('sendNEFTButton');
    button.disabled = true; // Disable button

    if (username) {
        fetch(`http://localhost:3001/dashboard?username=${username}`)
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    const user = data.user;
                    const scaccountnumber = user.account_number;
                    const destinationAccountNumber = document.getElementById("destAccNoNEFT").value;
                    const amount = parseFloat(document.getElementById("amountNEFT").value);

                    // Validate amount for NEFT
                    if (amount >= 200000) {
                        document.getElementById("neftError").style.display = "block";
                        return;
                    }
                    document.getElementById("neftError").style.display = "none";

                    // Send NEFT request to the server
                    fetch('http://localhost:3001/transfer/neft', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ scaccountnumber, destinationAccountNumber, amount })
                    })
                    .then(response => response.json())
                    .then(data => alert(data.message))
                    .catch(error => console.error('Error:', error));
                } else {
                    console.log('Error fetching profile data:', data.error);
                }
            });
    } else {
        console.log('No username found in localStorage.');
        button.disabled = false; // Enable button

    }
}

// Open the IMPS Transfer form
function openImps() {
    // Set the transfer type to IMPS
    const transferType = 'IMPS';
    
    // Show the IMPS form and hide other forms if necessary
    document.getElementById('impsForm').style.display = 'block'; // Show IMPS form
    document.getElementById('rtgsForm').style.display = 'none'; // Hide RTGS form
    document.getElementById('neftForm').style.display = 'none'; // Show NEFT form
    document.getElementById('ddForm').style.display = 'none'; // Hide DD form
    document.getElementById('profileInfo').style.display = 'none'; // Hide Profile section
    document.getElementById('previousFDsContainer').style.display = 'none';
    // Other sections hidden as required
    document.getElementById('loanListContainer').style.display = 'none'; // Hide loan list initially
    const rechargeForm = document.getElementById('rechargeform');
    rechargeForm.style.display = 'none';

    // Optionally hide other sections/forms if necessary
    document.getElementById('electricityForm').style.display = 'none'; 
    document.getElementById('waterform').style.display = 'none';
    document.getElementById('Lpgform').style.display = 'none';
    transactionTable.style.display = 'none';


    
    // Reset the IMPS form
    resetForm('imps');
}

// Reset the form fields
function resetForm(type) {
    if (type === 'imps') {
        document.getElementById('mobileNumberImps').value = '';  // Reset mobile number field
        document.getElementById('amountImps').value = '';  // Reset amount field
        document.getElementById('impsError').style.display = 'none'; // Hide error message
    }
}

// Function to send IMPS request
function sendImps() {
    const button = document.getElementById('sendImpsButton');
    button.disabled = true; // Disable the button to prevent multiple clicks

    // Retrieve the username from localStorage (or another method of user session management)
    const username = localStorage.getItem('username');

    if (username) {
        // Fetch user profile to get source account number
        fetch(`http://localhost:3001/dashboard?username=${username}`)
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    const user = data.user;
                    const scaccountnumber = user.account_number;  // Get source account number
                    const mobileNumber = document.getElementById("mobileNumberImps").value;  // Get mobile number from form
                    const amount = parseFloat(document.getElementById("amountImps").value);  // Get amount from form

                    // Validate amount for IMPS
                    if (amount <= 0) {
                        document.getElementById("impsError").style.display = "block";  // Show error if amount is invalid
                        button.disabled = false;  // Re-enable button
                        return;
                    }
                    document.getElementById("impsError").style.display = "none";  // Hide error message

                    // Send IMPS request to the backend
                    fetch('http://localhost:3001/transfer/imps', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ scaccountnumber, mobileNumber, amount })
                    })
                    .then(response => response.json())
                    .then(data => {
                        alert(data.message);  // Show success message
                        button.disabled = false;  // Re-enable the button
                    })
                    .catch(error => {
                        console.error('Error:', error);
                        button.disabled = false;  // Re-enable the button on error
                    });
                } else {
                    console.log('Error fetching profile data:', data.error);
                    button.disabled = false;  // Re-enable the button
                }
            });
    } else {
        console.log('No username found in localStorage.');
        button.disabled = false;  // Re-enable the button
    }
}


function openBillPayments() {
    document.getElementById('fundTransferPanel').style.display = 'none';
    document.getElementById('billPaymentsSection').style.display = 'block';
    document.getElementById('profileInfo').style.display = 'none'; // Hide Profile section
    const passbookTableContainer = document.getElementById('passbookTableContainer');
    passbookTableContainer.style.display = 'none';
    document.getElementById('fdFormContainer').style.display = 'none';
    const accountClosureFormContainer = document.getElementById('accountClosureFormContainer');
    accountClosureFormContainer.style.display = 'none';
    loanMgmtFormContainer.style.display = "none";
    document.getElementById('previousFDsContainer').style.display = 'none';
    // Other sections hidden as required
    document.getElementById('loanListContainer').style.display = 'none'; // Hide loan list initially
    transactionTable.style.display = 'none';
    document.querySelector('.transaction-heading').style.display = 'none';
    
  
    // Hide other sections as needed
}
function openElectric() {
    // Show the Electricity Billing form
    const billingForm = document.getElementById('electricityForm');
    billingForm.style.display = 'block';

    // Hide other sections if necessary
    document.getElementById('waterform').style.display = 'none';
    document.getElementById('Lpgform').style.display = 'none';
    document.getElementById('rechargeform').style.display = 'none';
    transactionTable.style.display = 'none';

    // Optionally, you can reset the form fields here if needed
    document.getElementById('consumerNumber').value = ''; // Clear consumer number field
    document.getElementById('amount').value = ''; // Clear amount field
}
async function proceedElectricBill() {
    const username = localStorage.getItem('username'); // Assuming username is stored in local storage
    const companyName = document.getElementById('companyName').value;
    const consumerNumber = document.getElementById('consumerNumber').value;
    const amount = parseFloat(document.getElementById('amount').value);
    const errorDiv = document.getElementById('billingError');

    let errorMessage = "";

    // Validate the form fields
    if (companyName === "") {
        errorMessage += "Please select a company name. ";
    }

    const consumerNumberRegex = /^CN\d{10}$/; // Assuming consumer number should start with 'CN' followed by 10 digits
    if (!consumerNumber || !consumerNumberRegex.test(consumerNumber)) {
        errorMessage += "Consumer number must start with 'CN' and be exactly 12 characters long. ";
    }

    if (amount <= 0 || isNaN(amount)) {
        errorMessage += "Please enter a valid amount greater than 0. ";
    }

    // Show error message if there are validation issues
    if (errorMessage !== "") {
        errorDiv.innerText = errorMessage;
        errorDiv.style.display = 'block';
        return; // Stop further execution if there's an error
    } else {
        errorDiv.style.display = 'none';
    }

    // Create the payload for saving the electricity bill data
    const billData = {
        company_name: companyName,
        consumer_number: consumerNumber,
        amount: amount
    };

    // Send the bill data to your backend to save it
    try {
        const response = await fetch('http://localhost:3001/saveElectricityBill', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(billData)
        });

        const result = await response.json();

        if (response.ok) {
            alert('Electricity bill payed successfully!');
            console.log('Success:', result);
        } else {
            throw new Error(result.message);
        }
    } catch (error) {
        console.error('Error saving electricity bill data:', error);
        alert('Error: ' + error.message);
    }
}


function openWater() {
    // Show the Water Billing form
    const waterForm = document.getElementById('waterform');
    waterForm.style.display = 'block';
    // Optionally, hide other sections/forms
document.getElementById('electricityForm').style.display = 'none';
document.getElementById('Lpgform').style.display = 'none';
document.getElementById('rechargeform').style.display = 'none';
    // Optionally, fetch data

      // Optionally, you can reset the form fields here if needed
    document.getElementById('consumerNumber').value = ''; // Clear consumer number field
    document.getElementById('amount').value = ''; // Clear amount field

}

async function proceedWater() {
    const username = localStorage.getItem('username'); // Assuming username is stored in local storage
    const consumerNumber = document.getElementById('consumerNumberWater').value;
    const companyName = document.getElementById('companyNameWater').value;
    const amount = parseFloat(document.getElementById('amountWater').value);
    const errorDiv = document.getElementById('billingErrorWater');

    let errorMessage = "";

    // Validation logic: check if any field is empty or invalid
    if (!username) {
        errorMessage += "User must be logged in. ";
    }

    // Validate consumer number: starts with "CN" and exactly 12 characters long
    const consumerNumberRegex = /^CN\d{10}$/;  // CN followed by 10 digits

    if (!consumerNumber || !consumerNumberRegex.test(consumerNumber)) {
        errorMessage += "Consumer number must start with 'CN' and be exactly 12 characters long. ";
    }

    if (amount <= 0 || isNaN(amount)) {
        errorMessage += "Please enter a valid amount greater than 0. ";
    }

    if (companyName === "") {
        errorMessage += "Please select a company name. ";
    }

    // If there's an error message, show it
    if (errorMessage !== "") {
        errorDiv.innerText = errorMessage;
        errorDiv.style.display = 'block';
        return; // Stop further execution if there's an error
    }

    // If all fields are valid, hide the error message
    errorDiv.style.display = 'none';

    // Create the payload
    const billData = {
        company_name: companyName,
        consumer_number: consumerNumber, // Use the consumer number retrieved from local storage
        amount: amount
    };

    // Send the data to the backend
    try {
        const response = await fetch('http://localhost:3001/saveWaterBill', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(billData)
        });

        const result = await response.json();

        if (response.ok) {
            alert('Water bill processed and records updated successfully!');
            console.log('Success:', result);
        } else {
            throw new Error(result.message);
        }
    } catch (error) {
        console.error('Error processing water bill:', error);
        alert('Error: ' + error.message);
    }
}
function openLpg() {
    // Show the LPG Billing form
    const lpgForm = document.getElementById('Lpgform');
    lpgForm.style.display = 'block';

    // Optionally, hide other forms
   document.getElementById('electricityForm').style.display = 'none'; 
    document.getElementById('waterform').style.display = 'none';
    document.getElementById('rechargeform').style.display = 'none';
    transactionTable.style.display = 'none';

    // Optionally, fetch data
    
    // Optionally, you can reset the form fields here if needed
    document.getElementById('consumerNumber').value = ''; // Clear consumer number field
    document.getElementById('amount').value = ''; // Clear amount field
}
async function proceedLpg() {
    const username = localStorage.getItem('username'); // Assuming username is stored in local storage
    const consumerNumber = document.getElementById('consumerNumberLpg').value;
    const amount = parseFloat(document.getElementById('amountLpg').value);
    const companyName = document.getElementById('companyNameLpg').value;
    const errorDiv = document.getElementById('billingErrorLpg');

    let errorMessage = "";

    // Validation logic: check if any field is empty or invalid
    if (!username) {
        errorMessage += "User must be logged in. ";
    }

    const consumerNumberRegex = /^CN\d{10}$/; // Assuming consumer number should start with 'CN' followed by 10 digits
    if (!consumerNumber || !consumerNumberRegex.test(consumerNumber)) {
        errorMessage += "Consumer number must start with 'CN' and be exactly 12 characters long. ";
    }

    if (amount <= 0 || isNaN(amount)) {
        errorMessage += "Please enter a valid amount greater than 0. ";
    }

    if (companyName === "") {
        errorMessage += "Please select a company name. ";
    }

    // If there's an error message, show it
    if (errorMessage !== "") {
        errorDiv.innerText = errorMessage;
        errorDiv.style.display = 'block';
        return; // Stop further execution if there's an error
    } else {
        errorDiv.style.display = 'none'; // Hide error message if all fields are valid
    }

    // Create the payload for saving the LPG bill data
    const billData = {
        company_name: companyName,
        consumer_number: consumerNumber,
        amount: amount
    };

    // Send the bill data to your backend to save it
    try {
        const response = await fetch('http://localhost:3001/saveLpgBill', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(billData)
        });

        const result = await response.json();

        if (response.ok) {
            alert('LPG bill processed and records updated successfully!');
            console.log('Success:', result);
        } else {
            throw new Error(result.message);
        }
    } catch (error) {
        console.error('Error saving LPG bill data:', error);
        alert('Error: ' + error.message);
    }
}

function openRecharge() {
    // Show the Mobile Recharge form
    const rechargeForm = document.getElementById('rechargeform');
    rechargeForm.style.display = 'block';

    // Optionally hide other sections/forms if necessary
    document.getElementById('electricityForm').style.display = 'none'; 
    document.getElementById('waterform').style.display = 'none';
    document.getElementById('Lpgform').style.display = 'none';

    // Optionally, you can reset the form fields here if needed
    document.getElementById('consumerNumber').value = ''; // Clear consumer number field
    document.getElementById('amount').value = ''; // Clear amount field
    transactionTable.style.display = 'none';
    document.querySelector('.transaction-heading').style.display = 'none';

}

async function proceedRecharge() {
    const mobileNumber = document.getElementById('mobileNumber').value;
    const mobileOperator = document.getElementById('mobileOperator').value;
    const region = document.getElementById('region').value;
    const amount = parseFloat(document.getElementById('amountRecharge').value);
    const errorDiv = document.getElementById('rechargeError');

    let errorMessage = "";

    // Validate the form fields
    if (mobileNumber === "" || mobileNumber.length !== 10) {
        errorMessage += "Please enter a valid 10-digit mobile number. ";
    }

    if (mobileOperator === "") {
        errorMessage += "Please select a mobile operator. ";
    }

    if (region === "") {
        errorMessage += "Please select a region. ";
    }

    if (amount <= 0 || isNaN(amount)) {
        errorMessage += "Please enter a valid amount greater than 0. ";
    }

    // Show error message if there are validation issues
    if (errorMessage !== "") {
        errorDiv.innerText = errorMessage;
        errorDiv.style.display = 'block';
        return; // Stop further execution if there's an error
    } else {
        errorDiv.style.display = 'none';

        // Create payload for processing the mobile recharge data
        const rechargeData = {
            mobile_number: mobileNumber,
            mobile_operator: mobileOperator,
            region: region,
            amount: amount
        };

        // Send the recharge data to your backend to save it
        try {
            const response = await fetch('http://localhost:3001/saveRecharge', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(rechargeData)
            });

            if (!response.ok) {
                throw new Error('Failed to save recharge data: ' + response.statusText);
            }

            const result = await response.json();
            console.log('Recharge processed successfully:', result);
            alert('Mobile recharge payed successfully!');
        } catch (error) {
            console.error('Error processing recharge data:', error);
            alert('Error: ' + error.message);
        }
    }
}











document.getElementById('electricityBillButton').addEventListener('click', function() {
    // Handle electricity bill payment
});

document.getElementById('waterBillButton').addEventListener('click', function() {
    // Handle water bill payment
});

document.getElementById('lpgBillButton').addEventListener('click', function() {
    // Handle LPG bill payment
});

document.getElementById('mobileRechargeButton').addEventListener('click', function() {
    // Handle mobile recharge
});
function resetForm(type) {
    if (type === 'rtgs') {
        document.getElementById('accNoRTGS').value = '';
        document.getElementById('customerNameRTGS').value = '';
        document.getElementById('accTypeRTGS').value = '';
        document.getElementById('particularsRTGS').value = '';
        document.getElementById('amountRTGS').value = '';
        document.getElementById('rtgsError').style.display = 'none'; // Hide RTGS error message
    } else if (type === 'neft') {
        document.getElementById('accNoNEFT').value = '';
        document.getElementById('customerNameNEFT').value = '';
        document.getElementById('accTypeNEFT').value = '';
        document.getElementById('particularsNEFT').value = '';
        document.getElementById('amountNEFT').value = '';
    }
}





// Placeholder functions for other transfer types


function openDD() {
    transferType = 'DD';
    document.getElementById('ddForm').style.display = 'block'; // Show DD form
    document.getElementById('rtgsForm').style.display = 'none'; // Hide RTGS form
    document.getElementById('neftForm').style.display = 'none'; // Hide NEFT form
    document.getElementById('impsForm').style.display = 'none'; // Hide UPI form
    // Other sections hidden as required
    document.getElementById('loanListContainer').style.display = 'none'; // Hide loan list initially
    const rechargeForm = document.getElementById('rechargeform');
    rechargeForm.style.display = 'none';

    // Optionally hide other sections/forms if necessary
    document.getElementById('electricityForm').style.display = 'none'; 
    document.getElementById('waterform').style.display = 'none';
    document.getElementById('Lpgform').style.display = 'none';
    transactionTable.style.display = 'none';
    document.querySelector('.transaction-heading').style.display = 'none';
    hideUPIButtons();


    resetForm('dd'); // Reset DD form
}
function resetForm(type) {
    if (type === 'dd') {
        document.getElementById('payeeName').value = '';
        document.getElementById('ddAmount').value = '';
        document.getElementById('ddResult').style.display = 'none'; // Hide DD result
    }
}

async function processDD() {
    const username = localStorage.getItem('username');
    const payeeName = document.getElementById('payeeName').value;
    const amount = parseFloat(document.getElementById('ddAmount').value);
    
    const button = document.getElementById('processDDButton');
    const referenceNumber = Math.floor(Math.random() * 1000000000); // Random 9-digit number
  

    // Disable button after click to avoid multiple submissions
    button.disabled = true;

    // Validation
    if (!payeeName || isNaN(amount) || amount <= 0) {
        alert('Please fill in all fields correctly.');
        button.disabled = false; // Re-enable the button
        return;
    }

    if (username) {
        try {
            // Fetch user account details using the username
            const userResponse = await fetch(`http://localhost:3001/dashboard?username=${username}`);
            const userData = await userResponse.json();

            if (userData.success) {
                const user = userData.user;
                const sourceAccountNumber = user.account_number;  // Extract the source account number from user data

                let charges = 0;
                // Charge calculation logic
                if (amount < 10000) {
                    alert('Demand Draft amount must be at least Rs 10,000.');
                    button.disabled = false;
                    return;
                } else if (amount <= 20000) {
                    charges = 100;
                } else if (amount <= 50000) {
                    charges = 200;
                } else if (amount <= 100000) {
                    charges = 300;
                } else if (amount <= 200000) {
                    charges = 500;
                } else {
                    charges = 700;
                }

                const totalAmount = amount + charges;

                // Proceed with the DD transfer
                const ddResponse = await fetch('http://localhost:3001/transfer/dd', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ payeeName, amount, charges, totalAmount, referenceNumber, sourceAccountNumber })
                });
                const ddData = await ddResponse.json();

                if (ddData.success) {
                     // Check if the element exists before setting the content
                     const referenceNumberElement = document.getElementById('referenceNumber');
                    if (referenceNumberElement) {
                        referenceNumberElement.textContent = `Reference Number: ${referenceNumber}`;
                    } else {
                        console.warn('Reference number element not found!');
                    }
                    
                    // Show the modal
                    document.getElementById('modalReferenceNumber').textContent = referenceNumber;
                    document.getElementById('ddModal').style.display = 'block'; // Show modal
                    
                } else {
                    alert(`Error: ${ddData.message}`);  // Display detailed error message
                    console.error('Backend error:', ddData.error);  // Log the actual error
                }
            } else {
                alert('Error fetching user data.');
            }
        } catch (error) {
            console.error('Error:', error);
        } finally {
            button.disabled = false;  // Always re-enable the button after processing
        }
    }
}
function closeModal() {
    document.getElementById('ddModal').style.display = 'none';
}

// Function to generate PDF
/*function generatePDF(referenceNumber, amount, payeeName) {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();
    const today = new Date().toLocaleDateString();

    doc.text('Demand Draft Details', 10, 10);
    doc.text(`Reference Number: ${referenceNumber}`, 10, 20);
    doc.text(`Amount: Rs ${amount}`, 10, 30);
    doc.text(`Payee Name: ${payeeName}`, 10, 40);
    doc.text(`Date: ${today}`, 10, 50);

    doc.save(`Demand_Draft_${referenceNumber}.pdf`);
}*/

function openPassbook() {
    const passbookTableContainer = document.getElementById('passbookTableContainer');
    passbookTableContainer.style.display = 'block';
    document.getElementById('fundTransferPanel').style.display = 'none';
    document.getElementById('profileInfo').style.display = 'none'; // Hide Profile section
    document.getElementById('billPaymentsSection').style.display = 'none';
    document.getElementById('fdFormContainer').style.display = 'none';
    const accountClosureFormContainer = document.getElementById('accountClosureFormContainer');
    accountClosureFormContainer.style.display = 'none';
    loanMgmtFormContainer.style.display = "none";
    document.getElementById('previousFDsContainer').style.display = 'none';
    // Other sections hidden as required
    document.getElementById('loanListContainer').style.display = 'none'; // Hide loan list initially
    const rechargeForm = document.getElementById('rechargeform');
    rechargeForm.style.display = 'none';

    // Optionally hide other sections/forms if necessary
    document.getElementById('electricityForm').style.display = 'none'; 
    document.getElementById('waterform').style.display = 'none';
    document.getElementById('Lpgform').style.display = 'none';
    transactionTable.style.display = 'none';
    document.querySelector('.transaction-heading').style.display = 'none';

}

// Function to fetch transactions and populate the passbook table
function fetchTransactions() {
    const username = localStorage.getItem('username');
    
    // Fetch user data based on username
    fetch(`http://localhost:3001/dashboard?username=${username}`)
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                const user = data.user;
                const customerId = user.customer_id; // Get customer ID from user data
                
                // Set the customer ID in the passbook input field
                document.getElementById('customerIdPass').value = customerId;

                // Fetch transactions from the database using customer ID
                fetch(`http://localhost:3001/transactions?customer_id=${customerId}`)
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            const transactions = data.transactions;
                            const passbookTableBody = document.getElementById('passbookTableBody');

                            // Clear the table body
                            passbookTableBody.innerHTML = '';

                            // Populate the table body with transactions
                            transactions.forEach(transaction => {
                                const row = document.createElement('tr');
                                row.innerHTML = `
                                    <td>${new Date(transaction.date).toLocaleDateString()}</td> <!-- Formatting date to readable format -->
                                    <td>${transaction.particulars}</td>
                                    <td>${transaction.amount > 0 ? `Credit: ${transaction.amount}` : `Debit: ${Math.abs(transaction.amount)}`}</td>
                                    <td>${transaction.balance_after}</td>
                                `;
                                passbookTableBody.appendChild(row);
                            });
                        } else {
                            console.log('Error fetching transactions:', data.error);
                        }
                    })
                    .catch(error => console.error('Error:', error));
            } else {
                console.log('Error fetching user data:', data.error);
            }
        })
        .catch(error => console.error('Error:', error));
}

document.getElementById('fetchTransactions').addEventListener('click', fetchTransactions);
function generateStatement() {
    // Get username from localStorage
    const username = localStorage.getItem('username');

    // Fetch user data based on username to get customer ID
    fetch(`http://localhost:3001/dashboard?username=${username}`)
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                const user = data.user;
                const customerId = user.customer_id; // Get customer ID from user data

                const startDate = document.getElementById('startDate').value;
                const endDate = document.getElementById('endDate').value;

                // Check if customer_id exists
                if (!customerId) {
                    alert("Customer ID not found!");
                    return;
                }

                // Check if both startDate and endDate are selected
                if (!startDate || !endDate) {
                    alert("Please select a valid start date and end date.");
                    return;
                }

                // Build the URL with the customer ID and date range
                const url = `http://localhost:3001/generateStatement?customer_id=${customerId}&startDate=${startDate}&endDate=${endDate}`;

                // Fetch the transactions within the date range
                fetch(url)
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Network response was not ok');
                        }
                        return response.json();
                    })
                    .then(data => {
                        if (data.success) {
                            const transactions = data.transactions;
                            const passbookTableBody = document.getElementById('passbookTableBody');

                            // Clear the table body before inserting new data
                            passbookTableBody.innerHTML = '';

                            // Populate the table body with fetched transactions
                            transactions.forEach(transaction => {
                                const row = document.createElement('tr');
                                row.innerHTML = `
                                    <td>${new Date(transaction.date).toLocaleDateString()}</td>
                                    <td>${transaction.particulars}</td>
                                    <td>${transaction.amount > 0 ? `Credit: ${transaction.amount}` : `Debit: ${Math.abs(transaction.amount)}`}</td>
                                    <td>${transaction.balance_after}</td>
                                `;
                                passbookTableBody.appendChild(row);
                            });
                        } else {
                            console.error('Error generating statement:', data.error);
                        }
                    })
                    .catch(error => {
                        console.error('Error fetching data:', error);
                        alert('An error occurred while generating the statement. Please try again later.');
                    });
            } else {
                console.log('Error fetching user data:', data.error);
            }
        })
        .catch(error => console.error('Error:', error));
}

// Attach the function to the Generate Statement button
document.getElementById('generateStatementButton').addEventListener('click', generateStatement);


// Function to open the Fixed Deposit (FD) form
function openFD() {
    document.getElementById('fdFormContainer').style.display = 'block';
    document.getElementById('fundTransferPanel').style.display = 'none';
    document.getElementById('profileInfo').style.display = 'none'; // Hide Profile section
    document.getElementById('billPaymentsSection').style.display = 'none';
    const passbookTableContainer = document.getElementById('passbookTableContainer');
    passbookTableContainer.style.display = 'none';
    const accountClosureFormContainer = document.getElementById('accountClosureFormContainer');
    accountClosureFormContainer.style.display = 'none';
    loanMgmtFormContainer.style.display = "none";
    document.getElementById('previousFDsContainer').style.display = 'block';
    // Other sections hidden as required
    document.getElementById('loanListContainer').style.display = 'none'; // Hide loan list initially
    const rechargeForm = document.getElementById('rechargeform');
    rechargeForm.style.display = 'none';
    transactionTable.style.display = 'none';

    // Optionally hide other sections/forms if necessary
    document.getElementById('electricityForm').style.display = 'none'; 
    document.getElementById('waterform').style.display = 'none';
    document.getElementById('Lpgform').style.display = 'none';
    document.querySelector('.transaction-heading').style.display = 'none';

    // Fetch customer ID, name, and age directly
    const username = localStorage.getItem('username');
    if (username) {
        fetch(`http://localhost:3001/dashboard?username=${username}`)
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    const user = data.user;
                    document.getElementById('customerID').value = user.customer_id;
                    document.getElementById('customerName').value = user.name;

                    // Calculate age from date of birth
                    const dob = new Date(user.dob);
                    const today = new Date();
                    const age = today.getFullYear() - dob.getFullYear();
                    document.getElementById('age').value = age;
                }
            });
    }
}

// Function to show previous FDs
function showPreviousFDs() {
    document.getElementById('fdFormContainer').style.display = 'block';
    document.getElementById('previousFDsContainer').style.display = 'block';
    // Other sections hidden as required
    document.getElementById('loanListContainer').style.display = 'none'; // Hide loan list initially
    const rechargeForm = document.getElementById('rechargeform');
    rechargeForm.style.display = 'none';


    // Optionally hide other sections/forms if necessary
    document.getElementById('electricityForm').style.display = 'none'; 
    document.getElementById('waterform').style.display = 'none';
    document.getElementById('Lpgform').style.display = 'none';
    transactionTable.style.display = 'none';
    document.querySelector('.transaction-heading').style.display = 'none';

    const customerId = document.getElementById('customerID').value;

    // Fetch the previous FDs from the server for the specific customer ID
    fetch(`http://localhost:3001/previousFDs?customerId=${customerId}`, {
        method: 'GET ',
    })
    .then(response => {
        if (!response.ok) {
            throw new Error('Network response was not ok: ' + response.statusText);
        }
        return response.json();
    })
    .then(data => {
        const tbody = document.getElementById('previousFDsTable').querySelector('tbody');
        tbody.innerHTML = ''; // Clear any existing data

        if (data.success) {
            // Populate table with the returned fixed deposits
            data.fds.forEach(fd => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${fd.customer_name}</td>
                    <td>${fd.amount}</td>
                    <td>${fd.age}</td>
                    <td>${fd.tenure}</td>
                    <td>${fd.roi}</td>
                    <td>${fd.total_amount}</td>
                    <td>${new Date(fd.created_at).toLocaleDateString()}</td>
                `;
                tbody.appendChild(row);
            });
        } else {
            alert(data.message); // No FDs found
        }
    })
    .catch(error => {
        console.error('Error fetching previous FDs:', error);
        alert('Failed to retrieve previous FDs: ' + error.message);
    });
}

// Add event listeners to the fields
// Add event listeners for input changes and submission
document.getElementById('amountt').addEventListener('input', updateCalculations);
document.getElementById('tenuree').addEventListener('change', updateCalculations);
document.getElementById('submitFD').addEventListener('click', FDsubmit);

function updateCalculations() {
    const age = parseInt(document.getElementById('age').value, 10);
    const tenure = document.getElementById('tenuree').value;
    const amount = parseFloat(document.getElementById('amountt').value);

    // Update ROI calculation and display it
    const roi = calculateROI(age, tenure);
    // Calculate and display total amount after completion of tenure
    const totalAmount = calculateTotalAmount(amount, roi, tenure);
    document.getElementById('totalAmount').value = totalAmount.toFixed(2); // Display total amount


    // Calculate and update maturity date
    const maturityDate = calculateMaturityDate(tenure);
    document.getElementById('maturityDate').value = maturityDate.toISOString().split('T')[0];

    

}
// Function to calculate maturity date based on tenure
function calculateMaturityDate(tenure) {
    const startDate = new Date(); // Current date
    switch (tenure) {
        case "14 days":
            startDate.setDate(startDate.getDate() + 14);
            break;
        case "3 months":
            startDate.setMonth(startDate.getMonth() + 3);
            break;
        case "6 months":
            startDate.setMonth(startDate.getMonth() + 6);
            break;
        case "1 year":
            startDate.setFullYear(startDate.getFullYear() + 1);
            break;
        case "2 years":
            startDate.setFullYear(startDate.getFullYear() + 2);
            break;
        case "5 years":
            startDate.setFullYear(startDate.getFullYear() + 5);
            break;
        case "10 years":
            startDate.setFullYear(startDate.getFullYear() + 10);
            break;
        default:
            break;
    }
    return startDate;
}

function calculateROI(age, tenure) {
    let roi = 0;

    if (age < 60) {
        roi = (tenure === "14 days") ? 4.5 :
              (tenure === "3 months") ? 5.0 :
              (tenure === "6 months") ? 5.5 :
              (tenure === "1 year") ? 6.0 :
              (tenure === "2 years") ? 6.5 :
              (tenure === "5 years") ? 7.0 :
              (tenure === "10 years") ? 7.5 : 0;
    } else {
        roi = (tenure === "14 days") ? 5.0 :
              (tenure === "3 months") ? 5.5 :
              (tenure === "6 months") ? 6.0 :
              (tenure === "1 year") ? 6.5 :
              (tenure === "2 years") ? 7.0 :
              (tenure === "5 years") ? 7.5 :
              (tenure === "10 years") ? 8.0 : 0;
    }

    document.getElementById('roi').value = roi.toFixed(2); // Update ROI in the input field
    return roi;
}

// Function to calculate the total amount after completion of tenure
function calculateTotalAmount(amount, roi, tenure) {
    if (!amount || !roi) return 0;

    const years = getTenureInYears(tenure);
    return amount + (amount * (roi / 100) * years); // Total amount = principal + interest
}

// Function to convert tenure to years
function getTenureInYears(tenure) {
    switch (tenure) {
        case "14 days":
            return 14 / 365; // Approximate fraction of year
        case "3 months":
            return 3 / 12;
        case "6 months":
            return 6 / 12;
        case "1 year":
            return 1;
        case "2 years":
            return 2;
        case "5 years":
            return 5;
        case "10 years":
            return 10;
        default:
            return 0; // No valid tenure
    }
}

// Function to submit FD
function FDsubmit(event) {
    event.preventDefault(); // Prevent default form submission

    const button = document.getElementById('submitFD');
    button.disabled = true; // Disable the button immediately

    const customerId = document.getElementById('customerID').value;
    const customerName = document.getElementById('customerName').value;
    const amount = parseFloat(document.getElementById('amountt').value);
    const age = parseInt(document.getElementById('age').value, 10);
    const tenure = document.getElementById('tenuree').value;
    const maturityDate = document.getElementById('maturityDate').value;
    // Call functions to calculate ROI and total amount right before submission
    const roi = calculateROI(age, tenure);
    const totalAmount = calculateTotalAmount(amount, roi, tenure);

    

    // Validate form fields
    if (!customerId || !customerName || !amount || !age || !tenure || isNaN(roi) || isNaN(totalAmount)) {
        alert('Please fill out all fields correctly.');
        button.disabled = false; // Re-enable button on error
        return;
    }

    if (amount <= 0 || roi <= 0) {
        alert('Please enter positive values for amount and ROI.');
        button.disabled = false; // Re-enable button on error
        return;
    }

    if (age <= 0 || age > 150) {
        alert('Please enter a valid age.');
        button.disabled = false; // Re-enable button on error
        return;
    }

    if (amount > 9999999) {
        alert('Maximum limit for FD is 9000000.');
        button.disabled = false; // Re-enable button on error
        return;
    }

    // Prepare data for submission
    
    const data = { customerId, customerName, amount, age, tenure, roi, totalAmount, maturityDate }; // Add maturityDate

    // Send the data to the server
    fetch('http://localhost:3001/submitFD', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(data)
    })
    .then(response => {
        if (!response.ok) {
            throw new Error('Network response was not ok: ' + response.statusText);
        }
        return response.json();
    })
    .then(result => {
        alert(result.message); // Show success message
        document.getElementById('fdForm').reset(); // Reset form fields
        button.disabled = false; // Re-enable button

        // Deduct money from source account
        deductMoneyFromSourceAccount(amount);
    })
    .catch(error => {
        console.error('Error submitting FD:', error);
       // alert('Failed to create FD: ' + error.message); // Show error message
        button.disabled = false; // Re-enable button
    });
}

// Function to deduct money from source account
function deductMoneyFromSourceAccount(amount) {
    const sourceAccountNumber = document.getElementById('customerID').value;

    // Update source account balance
    const updateSourceBalance = `UPDATE accounts SET balance = balance - ? WHERE customer_id = ? AND balance >= ?`;
    db.query(updateSourceBalance, [amount, sourceAccountNumber, amount], (err, results) => {
        if (err) {
            console.error('Error updating source balance:', err);
            return;
        }
        if (results.affectedRows === 0) {
            console.error('Insufficient funds or invalid source account number.');
            return;
        }

        // Update sender balance in customers table
        const updateCustomersTableSender = `
            UPDATE customers
            SET balance = balance - ?
            WHERE customer_id = ?
        `;
        db.query(updateCustomersTableSender, [amount, sourceAccountNumber], (err) => {
            if (err) {
                console.error('Error updating customers table for sender:', err);
                return;
            }
        });

        // Insert transaction record
        const insertTransaction = `
            INSERT INTO transactions (customer_id, transaction_id, amount, date, particulars)
            VALUES (?, ?, ?, NOW(), ?)
        `;
        const transactionId = `TRX${Math.floor(Math.random() * 100000)}`;
        const particulars = `Fixed Deposit Creation`;
        db.query(insertTransaction, [sourceAccountNumber, transactionId, -amount, particulars], (err) => {
            if (err) {
                console.error('Error inserting transaction record:', err);
                return;
            }
        });
    });
}

// Function to show previous FDs
function showPreviousFDs() {
    document.getElementById('fdFormContainer').style.display = 'block';
    document.getElementById('previousFDsContainer').style.display = 'block';
    // Other sections hidden as required
    document.getElementById('loanListContainer').style.display = 'none'; // Hide loan list initially
    const rechargeForm = document.getElementById('rechargeform');
    rechargeForm.style.display = 'none';
    document.querySelector('.transaction-heading').style.display = 'none';

    // Optionally hide other sections/forms if necessary
    document.getElementById('electricityForm').style.display = 'none'; 
    document.getElementById('waterform').style.display = 'none';
    document.getElementById('Lpgform').style.display = 'none';
    transactionTable.style.display = 'none';

    // Fetch customer ID directly
    const username = localStorage.getItem('username');
    if (username) {
        fetch(`http://localhost:3001/dashboard?username=${username}`)
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    const user = data.user;
                    const customerId = user.customer_id;

                    // Fetch the previous FDs from the server for the specific customer ID
                    fetch(`http://localhost:3001/previousFDs?customerId=${customerId}`, {
                        method: 'GET',
                    })
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Network response was not ok: ' + response.statusText);
                        }
                        return response.json();
                    })
                    .then(data => {
                        const tbody = document.getElementById('previousFDsTable').querySelector('tbody');
                        tbody.innerHTML = ''; // Clear any existing data

                        if (data.success) {
                            // Populate table with the returned fixed deposits
                            data.fds.forEach(fd => {
                                const row = document.createElement('tr');
                                row.innerHTML = `
                                    <td>${fd.customer_name}</td>
                                    <td>${fd.amount}</td>
                                    <td>${fd.age}</td>
                                    <td>${fd.tenure}</td>
                                    <td>${fd.roi}</td>
                                    <td>${fd.total_amount}</td>
                                    <td>${new Date(fd.created_at).toLocaleDateString()}</td>
                                    <td>${new Date(fd.maturity_date).toLocaleDateString()}</td>
                                `;
                                tbody.appendChild(row);
                            });
                        } else {
                            alert(data.message); // No FDs found
                        }
                    })
                    .catch(error => {
                        console.error('Error fetching previous FDs:', error);
                        alert('Failed to retrieve previous FDs: ' + error.message);
                    });
                }
            });
    }
}
function openAccountClosure() {
    const accountClosureFormContainer = document.getElementById('accountClosureFormContainer');
    accountClosureFormContainer.style.display = 'block';
    document.getElementById('fundTransferPanel').style.display = 'none';
    document.getElementById('profileInfo').style.display = 'none'; // Hide Profile section
    document.getElementById('billPaymentsSection').style.display = 'none';
    const passbookTableContainer = document.getElementById('passbookTableContainer');
    passbookTableContainer.style.display = 'none';
    document.getElementById('fdFormContainer').style.display = 'none';
    loanMgmtFormContainer.style.display = "none";
    document.getElementById('previousFDsContainer').style.display = 'none';
    // Other sections hidden as required
    document.getElementById('loanListContainer').style.display = 'none'; // Hide loan list initially
    const rechargeForm = document.getElementById('rechargeform');
    rechargeForm.style.display = 'none';

    // Optionally hide other sections/forms if necessary
    document.getElementById('electricityForm').style.display = 'none'; 
    document.getElementById('waterform').style.display = 'none';
    document.getElementById('Lpgform').style.display = 'none';
    transactionTable.style.display = 'none';
    document.querySelector('.transaction-heading').style.display = 'none';

}
// Function to open the Loan Management form
// Function to open the Loan Management form
function openLoanManagement() {
    // Get the Loan Management form container element
    const loanMgmtFormContainer = document.getElementById("loanMgmtFormContainer");

    // Show the Loan Management form
    loanMgmtFormContainer.style.display = "block";
    document.getElementById('fundTransferPanel').style.display = 'none';
    document.getElementById('previousFDsContainer').style.display = 'none';
    document.getElementById('profileInfo').style.display = 'none'; // Hide Profile section
    document.getElementById('billPaymentsSection').style.display = 'none';
    document.getElementById('passbookTableContainer').style.display = 'none';
    document.getElementById('fdFormContainer').style.display = 'none';
    document.getElementById('accountClosureFormContainer').style.display = 'none';
    document.getElementById('rechargeform').style.display = 'none';
    document.getElementById('transactionTable').style.display = 'none';
    document.getElementById('electricityForm').style.display = 'none'; 
    document.getElementById('waterform').style.display = 'none';
    document.getElementById('Lpgform').style.display = 'none';
    document.getElementById('loanListContainer').style.display = 'none'; // Hide loan list initially
    document.querySelector('.transaction-heading').style.display = 'none';

    // Fetch customer ID directly using the username stored in localStorage
    const username = localStorage.getItem('username'); // Get 'username' from localStorage
    
    if (username) {
        fetch(`http://localhost:3001/dashboard?username=${username}`)
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    const customerId = data.user.customer_id; // Get customer_id from the API response
                    document.getElementById('customerId').value = customerId; // Populate the customer ID field
                } else {
                    alert('Failed to retrieve customer data.');
                }
            })
            .catch(error => {
                console.error('Error fetching customer data:', error);
                alert('Error fetching customer ID. Please try again.');
            });
    } else {
        alert('No username found in localStorage.');
    }
}

// Function to handle loan application form submission
function Loanapply(event) {
    event.preventDefault(); // Prevent default form submission

    const customerId = document.getElementById('customerId').value;
    const loanType = document.getElementById('loanType').value;
    const amount = document.getElementById('amount1').value;
    const tenure = document.getElementById('tenure').value;

    const data = {
        customerId: customerId,
        loanType: loanType,
        amount: amount,
        tenure: tenure
    };

    fetch('http://localhost:3001/apply-loan', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
    })
    .then(response => {
        if (!response.ok) {
            return response.json().then(errData => {
                throw new Error(errData.message || 'Server error');
            });
        }
        return response.json();
    })
    .then(data => {
        alert(data.message); // Display response message
        // Optionally, you can reset the form or redirect the user
    })
    .catch(error => {
        console.error('Error:', error);
        alert('An error occurred: ' + error.message);
    });
}

function Loanscheckprev() {
    // Fetch username from localStorage
    const storedUsername = localStorage.getItem('username');
    if (!storedUsername) {
        alert('No username found in localStorage.');
        return; // Exit the function if no username is found
    }

    // Fetch customer data using the stored username
    fetch(`http://localhost:3001/dashboard?username=${storedUsername}`)
        .then(response => {
            if (!response.ok) {
                // Log the error response for debugging
                console.error('Failed to fetch customer data:', response.status, response.statusText);
                throw new Error('Failed to fetch customer data: ' + response.statusText);
            }
            return response.json();
        })
        .then(customerData => {
            if (customerData.success) {
                const customerId = customerData.user.customer_id; // Get customer_id from the API response
                console.log('Fetching loans for customer ID:', customerId); // Log customer ID

                // Fetch previous loans using the retrieved customerId
                return fetch(`http://localhost:3001/get-loans`, { // Updated endpoint
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ customerId: customerId }) // Send customerId in the body
                });
            } else {
                alert('Failed to retrieve customer data: ' + (customerData.message || 'Unknown error'));
                throw new Error('Customer data retrieval failed');
            }
        })
        .then(response => {
            if (!response.ok) {
                console.error('Failed to fetch loan data:', response.status, response.statusText);
                throw new Error('Failed to fetch loan data: ' + response.statusText);
            }
            return response.json();
        })
        .then(loanData => {
            const loanTableBody = document.getElementById('loanTable').getElementsByTagName('tbody')[0];
            loanTableBody.innerHTML = ''; // Clear previous loan records

            if (loanData.success) {
                // Populate table with the returned loans
                loanData.loans.forEach(loan => {
                    const loanRow = document.createElement('tr');
                    loanRow.innerHTML = `
                        <td>${loan.loan_id}</td>
                        <td>${loan.loanType}</td> <!-- Ensure the property names match your API response -->
                        <td>${loan.amount}</td>
                        <td>${loan.tenure}</td>
                        <td>${loan.loanDate}</td> <!-- Ensure the property names match your API response -->
                        <td>${loan.referenceId}</td> <!-- Ensure the property names match your API response -->
                    `;
                    loanTableBody.appendChild(loanRow);
                });

                document.getElementById('loanListContainer').style.display = 'block'; // Show loan list
            } else {
                alert('No loans found: ' + (loanData.message || 'Unknown error'));
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('An error occurred: ' + error.message);
        });
}
// Function to handle account closure form submission
function accountClosure(event) {
    event.preventDefault(); // Prevent default form submission

    const customerid = document.getElementById('customerid').value;
    const reason = document.getElementById('reason').value;

    const data = {
        customerid: customerid,
        reason: reason
    };

    fetch('http://localhost:3001/close-account', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
    })
    .then(response => {
        if (!response.ok) {
            return response.json().then(errData => {
                throw new Error(errData.message || 'Server error');
            });
        }
        return response.json();
    })
    .then(data => {
        alert(data.message); // Display response message
        // Optionally, you can reset the form or redirect the user
    })
    .catch(error => {
        console.error('Error:', error);
        alert('An error occurred: ' + error.message);
    });
}

// Fetch and populate customer ID for account closure
function populateCustomerIDForClosure() {
    const username = localStorage.getItem('username');
    if (username) {
        fetch(`http://localhost:3001/dashboard?username=${username}`)
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    const user = data.user;
                    document.getElementById('customerid').value = user.customer_id;
                } else {
                    alert('Failed to retrieve customer data.');
                }
            })
            .catch (error => {
                console.error('Error fetching customer data:', error);
                alert('Error fetching customer ID. Please try again.');
            });
    } else {
        alert('No username found in localStorage.');
    }
}

// Call the function when the form loads
document.addEventListener('DOMContentLoaded', populateCustomerIDForClosure);
   window.onload = function() {
    document.getElementById('fdFormContainer').style.display = 'none';
    document.getElementById('previousFDsContainer').style.display = 'none';
    const passbookTableContainer = document.getElementById('passbookTableContainer');
    passbookTableContainer.style.display = 'none';
    document.getElementById('billPaymentsSection').style.display = 'none';
    document.getElementById('fundTransferPanel').style.display = 'none';
    const accountClosureFormContainer = document.getElementById('accountClosureFormContainer');
    accountClosureFormContainer.style.display = 'none';
    loanMgmtFormContainer.style.display = "none"; // Ensure loanMgmtFormContainer is defined
    document.getElementById('loanListContainer').style.display = 'none'; // Hide loan list initially
    const rechargeForm = document.getElementById('rechargeform');
    rechargeForm.style.display = 'none';

    // Optionally hide other sections/forms if necessary
    document.getElementById('electricityForm').style.display = 'none'; 
    document.getElementById('waterform').style.display = 'none';
    document.getElementById('Lpgform').style.display = 'none';
    

    // Fetch customer details
    const username = localStorage.getItem('username');
    if (username) {
        fetch(`http://localhost:3001/dashboard?username=${username}`)
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    const user = data.user;
                    document.getElementById('customerID').value = user.customer_id;
                    document.getElementById('customerName').value = user.name;
                    
                    // Fetch recent transactions
                    fetchRecentTransactions(user.customer_id);
                    
                    // Welcome message
                    document.getElementById('marqueeText').textContent = `Welcome, ${user.name}! Thank you for banking with Ideal Bank!`;
                }
            });
    }
};

// Function to fetch recent transactions
function fetchRecentTransactions(customerId) {
    fetch(`http://localhost:3001/recent-transactions`, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({ customerId })
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            displayTransactions(data.transactions);
        } else {
            console.error('Error fetching transactions:', data.message);
        }
    })
    .catch(error => {
        console.error('Error:', error);
    });
}

// Function to display transactions
function displayTransactions(transactions) {
    const transactionTable = document.getElementById('transactionTable'); // Ensure this table exists in your HTML
    transactionTable.innerHTML = ''; // Clear existing rows
    const transactionHeading = document.querySelector('.transaction-heading'); // Select the heading


    transactions.forEach(transaction => {
        const row = document.createElement('tr');
        const formattedDate = new Date(transaction.date).toLocaleDateString(); // Format the date to only show the date part
        row.innerHTML = `
            <td>${transaction.transaction_id}</td>
            <td>${transaction.amount}</td>
            <td>${formattedDate}</td> <!-- Display formatted date -->
            <td>${transaction.particulars}</td>
            <td>${transaction.balance_after}</td>
        `;
        transactionTable.appendChild(row);
    });
    if (transactions.length > 0) {
                transactionHeading.style.display = 'block'; // Show the heading
                transactionTable.style.display = 'table';   // Show the table
            }
        

        // Fetch transactions here and call displayTransactions(transactions) with the fetched data
     else {
        // If not on the intended page, ensure they remain hidden
        document.querySelector('.transaction-heading').style.display = 'none';
        document.getElementById('transactionTable').style.display = 'none';
    }
}


    </script>
</body>
</html>
